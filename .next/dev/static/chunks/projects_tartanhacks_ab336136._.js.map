{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,oMAAO,EAAC,IAAA,2KAAI,EAAC;AACtB","debugId":null}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/components/ui/badge.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst badgeVariants = cva(\n  'inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden',\n  {\n    variants: {\n      variant: {\n        default:\n          'border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90',\n        secondary:\n          'border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90',\n        destructive:\n          'border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  },\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'span'> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : 'span'\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,qMAAG,EACvB,kZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,sMAAI,GAAG;IAE9B,qBACE,wNAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KAhBS","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,qMAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,sMAAI,GAAG;IAE9B,qBACE,wNAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS","debugId":null}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/lib/supabase-client.ts"],"sourcesContent":["// Lightweight in-memory Supabase mock so the app runs with zero external services.\n// Supports the minimal chainable API surface we use in the UI and route handlers.\n\ntype TableName =\n  | 'incidents'\n  | 'police_stations'\n  | 'units'\n  | 'dispatches'\n  | 'checkpoints'\n  | 'unit_stats';\n\n// Seed data for local/offline demo\nconst db: Record<TableName, any[]> = {\n  incidents: [\n    {\n      id: 'robbery-forbes-morewood',\n      name: 'Robbery at Forbes & Morewood',\n      status: 'active',\n      priority: 'high',\n      risk: 'high',\n      lat: 40.4427,\n      lon: -79.9425,\n      containment: 15,\n      description: 'Reported robbery near CMU campus',\n      incident_type: 'robbery',\n      start_time: new Date().toISOString(),\n      last_update: new Date().toISOString(),\n      reported_by: 'Dispatch',\n    },\n    {\n      id: 'traffic-cmu',\n      name: 'Multi-vehicle collision on Fifth Ave',\n      status: 'active',\n      priority: 'medium',\n      risk: 'medium',\n      lat: 40.4433,\n      lon: -79.9490,\n      containment: 35,\n      description: '3-car collision blocking two lanes',\n      incident_type: 'traffic',\n      start_time: new Date().toISOString(),\n      last_update: new Date().toISOString(),\n      reported_by: '911',\n    },\n  ],\n  police_stations: [\n    { id: 1, name: 'Station 1 - Downtown', city: 'Pittsburgh', county: 'Allegheny', lat: 40.4406, lon: -79.9959, created_at: new Date().toISOString() },\n    { id: 2, name: 'Station 2 - North', city: 'Pittsburgh', county: 'Allegheny', lat: 40.4500, lon: -79.9500, created_at: new Date().toISOString() },\n    { id: 3, name: 'Station 3 - South', city: 'Pittsburgh', county: 'Allegheny', lat: 40.4300, lon: -79.9800, created_at: new Date().toISOString() },\n  ],\n  units: [],\n  dispatches: [],\n  checkpoints: [],\n  unit_stats: [],\n};\n\n// Create three units per station\ndb.police_stations.forEach((station) => {\n  Array.from({ length: 3 }).forEach((_, idx) => {\n    db.units.push({\n      id: `${station.id}-unit-${idx + 1}`,\n      station_id: station.id,\n      unit_number: `Unit ${station.id}-${idx + 1}`,\n      unit_type: idx === 2 ? 'k9' : 'patrol',\n      status: 'available',\n      current_lat: station.lat,\n      current_lon: station.lon,\n      incident_id: null,\n      dispatched_at: null,\n      arrived_at: null,\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString(),\n    });\n  });\n});\n\n// Helper to compute unit_stats view on the fly\nconst computeUnitStats = () => {\n  return db.police_stations.map((ps) => {\n    const units = db.units.filter((u) => u.station_id === ps.id);\n    return {\n      station_id: ps.id,\n      station_name: ps.name,\n      available_units: units.filter((u) => u.status === 'available').length,\n      dispatched_units: units.filter((u) => ['dispatched', 'en_route'].includes(u.status)).length,\n      on_scene_units: units.filter((u) => u.status === 'on_scene').length,\n      total_units: units.length,\n    };\n  });\n};\n\n// Utility clone\nconst clone = <T>(v: T): T => JSON.parse(JSON.stringify(v));\n\n// Query builder\nfunction buildSelect(table: TableName, rows: any[]) {\n  let working = [...rows];\n\n  const api: any = {\n    select: (_cols: string = '*') => api,\n    eq: (col: string, val: any) => {\n      working = working.filter((r) => r[col] === val);\n      return api;\n    },\n    in: (col: string, vals: any[]) => {\n      working = working.filter((r) => vals.includes(r[col]));\n      return api;\n    },\n    order: (col: string, opts: { ascending?: boolean } = {}) => {\n      const asc = opts.ascending !== false;\n      working = [...working].sort((a, b) => {\n        if (a[col] === b[col]) return 0;\n        return (a[col] > b[col] ? 1 : -1) * (asc ? 1 : -1);\n      });\n      return api;\n    },\n    limit: (n: number) => {\n      working = working.slice(0, n);\n      return Promise.resolve({ data: clone(working), error: null });\n    },\n    then: (resolve: any, reject: any) =>\n      Promise.resolve({ data: clone(working), error: null }).then(resolve, reject),\n  };\n\n  return api;\n}\n\nfunction buildUpdate(table: TableName, values: Record<string, any>) {\n  return {\n    eq: (col: string, val: any) => {\n      const updated: any[] = [];\n      db[table] = db[table].map((row) => {\n        if (row[col] === val) {\n          const next = { ...row, ...values, updated_at: new Date().toISOString() };\n          updated.push(next);\n          return next;\n        }\n        return row;\n      });\n      return Promise.resolve({ data: clone(updated), error: null });\n    },\n    in: (col: string, vals: any[]) => {\n      const updated: any[] = [];\n      db[table] = db[table].map((row) => {\n        if (vals.includes(row[col])) {\n          const next = { ...row, ...values, updated_at: new Date().toISOString() };\n          updated.push(next);\n          return next;\n        }\n        return row;\n      });\n      return Promise.resolve({ data: clone(updated), error: null });\n    },\n  };\n}\n\nfunction buildInsert(table: TableName, payload: any | any[]) {\n  const items = Array.isArray(payload) ? payload : [payload];\n  const withIds = items.map((item) => ({\n    ...item,\n    id: item.id || crypto.randomUUID?.() || `id-${Math.random().toString(36).slice(2, 8)}`,\n    created_at: new Date().toISOString(),\n    updated_at: new Date().toISOString(),\n  }));\n  db[table].push(...withIds);\n  return Promise.resolve({ data: clone(withIds), error: null });\n}\n\nfunction buildDelete(table: TableName) {\n  return {\n    eq: (col: string, val: any) => {\n      const removed = db[table].filter((row) => row[col] === val);\n      db[table] = db[table].filter((row) => row[col] !== val);\n      return Promise.resolve({ data: clone(removed), error: null });\n    },\n  };\n}\n\nconst mockChannel = () => {\n  const ch: any = {\n    on: () => ch,\n    subscribe: () => ch,\n    unsubscribe: () => {},\n  };\n  return ch;\n};\n\nexport const supabase: any = {\n  from: (table: TableName) => {\n    if (table === 'unit_stats') {\n      return buildSelect(table, computeUnitStats());\n    }\n    return {\n      select: (_cols: string = '*') => buildSelect(table, db[table]),\n      update: (values: Record<string, any>) => buildUpdate(table, values),\n      insert: (payload: any | any[]) => buildInsert(table, payload),\n      delete: () => buildDelete(table),\n    };\n  },\n  channel: (_name: string) => mockChannel(),\n  removeChannel: (_ch: any) => {},\n  // Expose db for debugging in dev tools\n  __data: db,\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 394, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/lib/video-mapping.ts"],"sourcesContent":["// Video mapping for fire incidents\nexport interface FireVideo {\n  name: string;\n  videoUrl?: string;\n  thumbnailUrl?: string;\n  description?: string;\n}\n\n// Map fire names to their corresponding video files\nexport const FIRE_VIDEOS: Record<string, FireVideo> = {\n  'Pine Ridge Fire': {\n    name: 'Pine Ridge Fire',\n    videoUrl: '/videos/pine-ridge-fire.mp4',\n    thumbnailUrl: '/videos/pine-ridge-fire-thumb.jpg',\n    description: 'Live footage from Pine Ridge Fire operations'\n  },\n  'Redwood Valley Fire': {\n    name: 'Redwood Valley Fire', \n    videoUrl: '/videos/redwood-valley-fire.mp4',\n    thumbnailUrl: '/videos/redwood-valley-fire-thumb.jpg',\n    description: 'Live footage from Redwood Valley Fire operations'\n  }\n};\n\n// Get video info for a fire by name\nexport function getFireVideo(fireName: string | null): FireVideo | null {\n  console.log('[getFireVideo] Looking for video for fire:', fireName);\n  console.log('[getFireVideo] Available fires:', Object.keys(FIRE_VIDEOS));\n  \n  if (!fireName) {\n    console.log('[getFireVideo] No fire name provided');\n    return null;\n  }\n  \n  // Try exact match first\n  if (FIRE_VIDEOS[fireName]) {\n    console.log('[getFireVideo] Found exact match:', FIRE_VIDEOS[fireName]);\n    return FIRE_VIDEOS[fireName];\n  }\n  \n  // Try partial match for variations in naming\n  const normalizedName = fireName.toLowerCase().trim();\n  console.log('[getFireVideo] Trying partial match with normalized name:', normalizedName);\n  \n  for (const [key, video] of Object.entries(FIRE_VIDEOS)) {\n    if (key.toLowerCase().includes(normalizedName) || normalizedName.includes(key.toLowerCase())) {\n      console.log('[getFireVideo] Found partial match:', key, video);\n      return video;\n    }\n  }\n  \n  console.log('[getFireVideo] No match found for:', fireName);\n  return null;\n}\n\n// Check if video is available\nexport function isVideoAvailable(fireName: string | null): boolean {\n  const video = getFireVideo(fireName);\n  return video?.videoUrl ? true : false;\n}\n"],"names":[],"mappings":"AAAA,mCAAmC;;;;;;;;;AAS5B,MAAM,cAAyC;IACpD,mBAAmB;QACjB,MAAM;QACN,UAAU;QACV,cAAc;QACd,aAAa;IACf;IACA,uBAAuB;QACrB,MAAM;QACN,UAAU;QACV,cAAc;QACd,aAAa;IACf;AACF;AAGO,SAAS,aAAa,QAAuB;IAClD,QAAQ,GAAG,CAAC,8CAA8C;IAC1D,QAAQ,GAAG,CAAC,mCAAmC,OAAO,IAAI,CAAC;IAE3D,IAAI,CAAC,UAAU;QACb,QAAQ,GAAG,CAAC;QACZ,OAAO;IACT;IAEA,wBAAwB;IACxB,IAAI,WAAW,CAAC,SAAS,EAAE;QACzB,QAAQ,GAAG,CAAC,qCAAqC,WAAW,CAAC,SAAS;QACtE,OAAO,WAAW,CAAC,SAAS;IAC9B;IAEA,6CAA6C;IAC7C,MAAM,iBAAiB,SAAS,WAAW,GAAG,IAAI;IAClD,QAAQ,GAAG,CAAC,6DAA6D;IAEzE,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,OAAO,OAAO,CAAC,aAAc;QACtD,IAAI,IAAI,WAAW,GAAG,QAAQ,CAAC,mBAAmB,eAAe,QAAQ,CAAC,IAAI,WAAW,KAAK;YAC5F,QAAQ,GAAG,CAAC,uCAAuC,KAAK;YACxD,OAAO;QACT;IACF;IAEA,QAAQ,GAAG,CAAC,sCAAsC;IAClD,OAAO;AACT;AAGO,SAAS,iBAAiB,QAAuB;IACtD,MAAM,QAAQ,aAAa;IAC3B,OAAO,OAAO,WAAW,OAAO;AAClC","debugId":null}},
    {"offset": {"line": 452, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/components/california-map.tsx"],"sourcesContent":["'use client';\n\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport type { Feature, FeatureCollection } from 'geojson';\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport { supabase } from '@/lib/supabase-client';\nimport VideoPreview from './VideoPreview';\nimport { getFireVideo } from '@/lib/video-mapping';\n\n// Incident type for navigation callback\ntype Incident = {\n  id: string | number;\n  name: string | null;\n  risk?: 'low' | 'medium' | 'high' | 'critical' | null;\n  lat: number | null;\n  lon: number | null;\n  containment?: number | null;\n  description?: string | null;\n  last_update?: string;\n};\n\n// California coordinates and bounds\nconst CALIFORNIA_BOUNDS = {\n  north: 42.0,\n  south: 32.5,\n  east: -114.0,\n  west: -124.5\n};\n\nconst getMarkerColor = (intensity: string) => {\n  switch (intensity) {\n    case 'critical': return '#FF6B00'; // Fire orange\n    case 'high': return '#FF4444'; // Bright red\n    case 'medium': return '#FF8C00'; // Dark orange\n    case 'low': return '#00C2FF'; // Cyan\n    default: return '#6b7280'; // gray\n  }\n};\n\nconst getMarkerSize = (intensity: string) => {\n  switch (intensity) {\n    case 'critical': return 24;\n    case 'high': return 20;\n    case 'medium': return 16;\n    case 'low': return 12;\n    default: return 14;\n  }\n};\n\nconst getPulseSize = (intensity: string) => {\n  switch (intensity) {\n    case 'critical': return 60;\n    case 'high': return 50;\n    case 'medium': return 40;\n    case 'low': return 30;\n    default: return 35;\n  }\n};\n\nconst METERS_PER_DEGREE_LAT = 111320;\n\n// Supabase incident type\ntype SupabaseIncident = {\n  id: string;\n  name: string | null;\n  status: 'active' | 'contained' | 'extinguished' | null;\n  risk: 'low' | 'medium' | 'high' | 'critical' | null;\n  lat: number | null;\n  lon: number | null;\n  containment: number | null;\n  start_time: string;\n  last_update: string;\n  description: string | null;\n};\n\n// Supabase police station type\ntype SupabasePoliceStation = {\n  id: number;\n  name: string;\n  city: string | null;\n  county: string | null;\n  lat: number;\n  lon: number;\n  created_at: string;\n};\n\n// Keep old name for backward compatibility\ntype SupabaseFirestation = SupabasePoliceStation;\n\n// Convert Supabase incident to map incident format\ntype WildfireIncident = {\n  id: number | string; // Support both number and UUID string\n  name: string;\n  status: string;\n  intensity: string;\n  coordinates: [number, number];\n  acres?: number;\n  description?: string;\n  containment?: number;\n  last_update?: string;\n};\n\ntype FireFeatureProperties = {\n  id: number;\n  intensity: number;\n  name: string;\n};\n\ninterface FireState {\n  baseRadius: number; // meters\n  roughness: number;\n  waveSpeed: number;\n  amplitude: number;\n  expansionRate: number;\n  seed: number;\n  growthVectors: number[]; // Random growth direction for each angle\n  startTime: number; // When this fire started\n  initialWindSpeed: number; // Wind speed when fire was created (locked)\n  initialWindDirection: number; // Wind direction when fire was created (locked)\n  containmentStartTime?: number; // When containment started\n  containmentRate?: number; // How fast fire shrinks (0-1 scale)\n  respondersOnScene?: number; // Number of responders actively containing fire\n  maxRadiusBeforeContainment?: number; // Lock fire size when containment starts\n}\n\n// Unit type (police unit/patrol car)\ntype Unit = {\n  id: string;\n  station_id: number;\n  firestation_id?: number; // Backward compatibility\n  incident_id: string;\n  unit_number?: string;\n  team_number?: number; // Backward compatibility\n  status: 'available' | 'dispatched' | 'en_route' | 'on_scene' | 'returning';\n  current_lat: number;\n  current_lon: number;\n  dispatched_at: string;\n  route?: any; // GeoJSON route\n  progress?: number; // 0-1, position along route\n  marker?: mapboxgl.Marker;\n}\n\n// Keep old name for backward compatibility\ntype Responder = Unit;\n\n// Convert Supabase incident to WildfireIncident format\nconst convertSupabaseIncident = (incident: SupabaseIncident): WildfireIncident => {\n  return {\n    id: incident.id as any, // Keep UUID as string, cast to number type for compatibility\n    name: incident.name || 'Unnamed Fire',\n    status: incident.status || 'active',\n    intensity: incident.risk || 'low',\n    coordinates: [incident.lon || 0, incident.lat || 0],\n    containment: incident.containment || 0,\n    description: incident.description || undefined,\n    last_update: incident.last_update\n  };\n};\n\n// Create popup content HTML\nconst createPopupContent = (incident: WildfireIncident): string => {\n  const videoInfo = getFireVideo(incident.name);\n  const hasVideo = Boolean(videoInfo?.videoUrl);\n  const intensityColor = getMarkerColor(incident.intensity);\n  \n  return `\n    <div class=\"rounded-lg overflow-hidden\" style=\"min-width: 320px;\">\n      <div class=\"px-4 pt-3 pb-2 bg-black/50 border-b border-white/10\">\n        <h3 class=\"text-base font-semibold text-white\">${incident.name}</h3>\n        ${incident.description ? `<p class=\"mt-1\" style=\"font-size: 14px; color: ${intensityColor}; line-height: 1.4; font-weight: 600;\">${incident.description}</p>` : ''}\n      </div>\n      ${hasVideo ? `\n        <div data-video-wrapper=\"true\" class=\"relative\" style=\"width: 100%; height: 140px; background: #000;\">\n          <video \n            data-video-element=\"true\"\n            style=\"width: 100%; height: 100%; object-fit: cover; cursor: pointer;\" \n            poster=\"${videoInfo?.thumbnailUrl || ''}\"\n            preload=\"metadata\" autoplay muted playsinline loop\n            onclick=\"this.paused ? this.play() : this.pause()\"\n          >\n            <source src=\"${videoInfo?.videoUrl}\" type=\"video/mp4\">\n            Your browser does not support the video tag.\n          </video>\n          <!-- Fullscreen removed per request -->\n        </div>\n      ` : `\n        <div class=\"px-4 py-3 bg-black/40 border-b border-white/10\">\n          <p class=\"text-sm font-semibold\" style=\"color: ${intensityColor}\">Livestream Unavailable</p>\n        </div>\n      `}\n      <div class=\"p-4 bg-black/40\">\n        <div class=\"space-y-1 text-sm\">\n          <div class=\"flex justify-between\">\n            <span class=\"text-white/70\">Status:</span>\n            <span class=\"font-semibold text-white\">${incident.status}</span>\n          </div>\n          <div class=\"flex justify-between\">\n            <span class=\"text-white/70\">Intensity:</span>\n            <span class=\"font-semibold\" style=\"color: ${intensityColor}\">${incident.intensity}</span>\n          </div>\n          ${incident.containment !== undefined ? `\n            <div class=\"flex justify-between\">\n              <span class=\"text-white/70\">Containment:</span>\n              <span class=\"font-semibold text-[#00C2FF]\">${incident.containment}%</span>\n            </div>\n          ` : ''}\n        </div>\n      </div>\n    </div>\n  `;\n};\n\n// Create popup content for police station\nconst createPoliceStationPopupContent = (station: SupabasePoliceStation): string => {\n  return createFirestationPopupContent(station);\n}\n\n// Keep old function for backward compatibility\nconst createFirestationPopupContent = (firestation: SupabaseFirestation | SupabasePoliceStation): string => {\n  return `\n    <div class=\"rounded-lg overflow-hidden bg-black/40 p-4\" style=\"min-width: 250px;\">\n      <h3 class=\"text-lg font-bold text-white mb-2\">${firestation.name}</h3>\n      <div class=\"space-y-1 text-sm\">\n        ${firestation.city ? `\n          <div class=\"flex justify-between\">\n            <span class=\"text-white/70\">City:</span>\n            <span class=\"font-semibold text-white\">${firestation.city}</span>\n          </div>\n        ` : ''}\n        ${firestation.county ? `\n          <div class=\"flex justify-between\">\n            <span class=\"text-white/70\">County:</span>\n            <span class=\"font-semibold text-white\">${firestation.county}</span>\n          </div>\n        ` : ''}\n        <div class=\"flex justify-between\">\n          <span class=\"text-white/70\">Type:</span>\n          <span class=\"font-semibold text-[#00C2FF]\">Fire Station</span>\n        </div>\n      </div>\n    </div>\n  `;\n};\n\n// Create firestation marker element with custom SVG icon\nconst createFirestationMarker = () => {\n  const markerEl = document.createElement('div');\n  markerEl.className = 'relative';\n  markerEl.style.cursor = 'pointer';\n  markerEl.style.width = '24px';\n  markerEl.style.height = '24px';\n  markerEl.style.zIndex = '50'; // Lower z-index so fires appear on top\n  \n  // Create a smaller, more subtle firestation icon\n  markerEl.innerHTML = `\n    <div style=\"\n      width: 24px;\n      height: 24px;\n      background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);\n      border: 2px solid #60a5fa;\n      border-radius: 6px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      box-shadow: 0 0 10px rgba(96, 165, 250, 0.6), 0 2px 4px rgba(0, 0, 0, 0.3);\n      transition: transform 0.2s;\n    \" \n    onmouseover=\"this.style.transform='scale(1.3)'\"\n    onmouseout=\"this.style.transform='scale(1)'\">\n      <span style=\"font-size: 14px; line-height: 1;\">ðŸš’</span>\n    </div>\n  `;\n  \n  return markerEl;\n};\n\n// Create animated firetruck marker\nconst createFiretruckMarker = (teamNumber: number) => {\n  const markerEl = document.createElement('div');\n  markerEl.className = 'relative';\n  markerEl.style.width = '32px';\n  markerEl.style.height = '32px';\n  markerEl.style.zIndex = '200'; // Very high z-index so trucks appear on top\n  \n  markerEl.innerHTML = `\n    <div style=\"\n      width: 32px;\n      height: 32px;\n      background: linear-gradient(135deg, #FF6B00 0%, #FF4444 100%);\n      border: 3px solid white;\n      border-radius: 8px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      box-shadow: 0 0 20px rgba(255, 107, 0, 0.8), 0 4px 8px rgba(0, 0, 0, 0.4);\n      animation: pulse-truck 1.5s ease-in-out infinite;\n      position: relative;\n    \">\n      <span style=\"font-size: 18px; line-height: 1; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.5));\">ðŸš’</span>\n    </div>\n    <style>\n      @keyframes pulse-truck {\n        0%, 100% { transform: scale(1); }\n        50% { transform: scale(1.1); }\n      }\n    </style>\n  `;\n  \n  return markerEl;\n};\n\n// Calculate a point along a line at a given progress (0-1)\nconst getPointAlongLine = (coordinates: [number, number][], progress: number): [number, number] => {\n  // Validate input\n  if (!coordinates || coordinates.length === 0) {\n    console.error('[getPointAlongLine] Empty coordinates array');\n    return [0, 0];\n  }\n  \n  if (coordinates.length === 1) {\n    return coordinates[0];\n  }\n  \n  if (progress <= 0) return coordinates[0];\n  if (progress >= 1) return coordinates[coordinates.length - 1];\n  \n  // Calculate total line length\n  let totalLength = 0;\n  const segmentLengths: number[] = [];\n  \n  for (let i = 0; i < coordinates.length - 1; i++) {\n    const coord1 = coordinates[i];\n    const coord2 = coordinates[i + 1];\n    \n    // Validate coordinate pairs\n    if (!coord1 || !coord2 || coord1.length < 2 || coord2.length < 2) {\n      console.error(`[getPointAlongLine] Invalid coordinate pair at index ${i}:`, coord1, coord2);\n      return coordinates[0];\n    }\n    \n    const [lon1, lat1] = coord1;\n    const [lon2, lat2] = coord2;\n    \n    // Validate numeric values\n    if (isNaN(lon1) || isNaN(lat1) || isNaN(lon2) || isNaN(lat2)) {\n      console.error(`[getPointAlongLine] NaN in coordinates at index ${i}:`, [lon1, lat1], [lon2, lat2]);\n      return coordinates[0];\n    }\n    \n    const segmentLength = Math.sqrt(\n      Math.pow(lon2 - lon1, 2) + Math.pow(lat2 - lat1, 2)\n    );\n    \n    if (isNaN(segmentLength) || segmentLength < 0) {\n      console.error(`[getPointAlongLine] Invalid segment length at index ${i}:`, segmentLength);\n      return coordinates[0];\n    }\n    \n    segmentLengths.push(segmentLength);\n    totalLength += segmentLength;\n  }\n  \n  // Handle edge case where all segments are zero length\n  if (totalLength === 0) {\n    return coordinates[0];\n  }\n  \n  // Find target position along line\n  const targetLength = totalLength * progress;\n  let currentLength = 0;\n  \n  for (let i = 0; i < segmentLengths.length; i++) {\n    if (currentLength + segmentLengths[i] >= targetLength) {\n      // Interpolate within this segment\n      const segmentLength = segmentLengths[i];\n      \n      // Avoid division by zero\n      if (segmentLength === 0) {\n        return coordinates[i];\n      }\n      \n      const segmentProgress = (targetLength - currentLength) / segmentLength;\n      const [lon1, lat1] = coordinates[i];\n      const [lon2, lat2] = coordinates[i + 1];\n      \n      const resultLon = lon1 + (lon2 - lon1) * segmentProgress;\n      const resultLat = lat1 + (lat2 - lat1) * segmentProgress;\n      \n      // Final validation\n      if (isNaN(resultLon) || isNaN(resultLat)) {\n        console.error('[getPointAlongLine] Calculated NaN position:', {\n          lon1, lat1, lon2, lat2, segmentProgress\n        });\n        return coordinates[i];\n      }\n      \n      return [resultLon, resultLat];\n    }\n    currentLength += segmentLengths[i];\n  }\n  \n  return coordinates[coordinates.length - 1];\n};\n\nconst clamp = (value: number, min: number, max: number) => Math.min(Math.max(value, min), max);\n\n// Calculate distance between two points using Haversine formula (in kilometers)\nconst calculateDistance = (lat1: number, lon1: number, lat2: number, lon2: number): number => {\n  const R = 6371; // Earth's radius in km\n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLon = (lon2 - lon1) * Math.PI / 180;\n  const a = \n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n};\n\n// Find nearest fire station to a given location\nconst findNearestFirestation = (\n  lat: number, \n  lon: number, \n  firestations: SupabaseFirestation[]\n): SupabaseFirestation | null => {\n  if (firestations.length === 0) return null;\n  \n  let nearest = firestations[0];\n  let minDistance = calculateDistance(lat, lon, nearest.lat, nearest.lon);\n  \n  for (let i = 1; i < firestations.length; i++) {\n    const distance = calculateDistance(lat, lon, firestations[i].lat, firestations[i].lon);\n    if (distance < minDistance) {\n      minDistance = distance;\n      nearest = firestations[i];\n    }\n  }\n  \n  return nearest;\n};\n\nconst getIntensityMultiplier = (intensity: string) => {\n  switch (intensity) {\n    case 'critical': return 1.25;\n    case 'high': return 1.1;\n    case 'medium': return 0.9;\n    case 'low':\n    default:\n      return 0.75;\n  }\n};\n\nconst getBaseRadiusMeters = (incident: WildfireIncident) => {\n  const acres = incident.acres ?? 500;\n  const intensityMultiplier = getIntensityMultiplier(incident.intensity);\n  const base = 150 + Math.sqrt(acres) * 2.5;\n  return base * intensityMultiplier;\n};\n\nconst getExpansionRate = (incident: WildfireIncident) => {\n  const intensityMultiplier = getIntensityMultiplier(incident.intensity);\n  return 18 * intensityMultiplier;\n};\n\n/**\n * Generate wind-influenced growth vectors\n * Wind direction is where wind comes FROM (meteorological convention)\n * Fire spreads in the OPPOSITE direction (downwind)\n * \n * @param numVectors - Number of directional segments\n * @param windSpeed - Wind speed in mph (higher = more directional bias)\n * @param windDirection - Wind direction in degrees (0=N, 90=E, 180=S, 270=W)\n * @returns Array of growth multipliers for each direction\n */\nconst generateWindInfluencedGrowthVectors = (\n  numVectors: number,\n  windSpeed: number,\n  windDirection: number\n): number[] => {\n  const growthVectors: number[] = [];\n  \n  // Convert wind direction to radians\n  // Fire spreads OPPOSITE to wind direction (add 180Â°)\n  const fireSpreadDirection = ((windDirection + 180) % 360) * (Math.PI / 180);\n  \n  // Wind influence factor (0-1): stronger winds = more directional spread\n  // 0 mph = no influence, 20+ mph = maximum influence\n  const windInfluence = Math.min(windSpeed / 20, 1);\n  \n  for (let i = 0; i < numVectors; i++) {\n    const angle = (i / numVectors) * Math.PI * 2;\n    \n    // Calculate how aligned this angle is with fire spread direction\n    // cos gives 1 when aligned, -1 when opposite\n    const alignment = Math.cos(angle - fireSpreadDirection);\n    \n    // Convert alignment to growth multiplier\n    // Downwind direction (aligned): higher growth\n    // Upwind direction (opposite): lower growth\n    // Perpendicular: neutral growth\n    const windEffect = 0.5 + (alignment * windInfluence * 0.7);\n    \n    // Add some random variation for organic spread\n    const randomVariation = 0.85 + Math.random() * 0.3;\n    \n    // Combine wind effect with random variation\n    const growthMultiplier = windEffect * randomVariation;\n    \n    growthVectors.push(growthMultiplier);\n  }\n  \n  return growthVectors;\n};\n\n/**\n * REALISTIC WIND-DRIVEN FIRE SPREAD SIMULATION\n * \n * This system creates organic, realistic fire spread patterns using:\n * 1. Real-time wind data (speed & direction from weather API)\n * 2. Wind-influenced directional growth (fires spread downwind)\n * 3. Multi-octave noise for irregular, natural edges\n * 4. Emergence from center (starts small, grows outward)\n * 5. Subtle edge movement for dynamic appearance\n * 6. Non-uniform expansion based on wind conditions\n * \n * Wind behavior:\n * - Stronger winds (>15 mph) create more directional spread\n * - Fire spreads opposite to wind direction (downwind)\n * - Perpendicular directions have neutral growth\n * - Upwind direction has reduced spread\n */\n\n// Simple noise function for organic fire spread\nconst noise = (x: number, y: number, seed: number): number => {\n  const n = Math.sin(x * 12.9898 + y * 78.233 + seed) * 43758.5453;\n  return n - Math.floor(n);\n};\n\n// Multi-octave noise for more organic patterns\nconst multiNoise = (x: number, y: number, seed: number, octaves: number = 3): number => {\n  let value = 0;\n  let amplitude = 1;\n  let frequency = 1;\n  let maxValue = 0;\n\n  for (let i = 0; i < octaves; i++) {\n    value += noise(x * frequency, y * frequency, seed + i) * amplitude;\n    maxValue += amplitude;\n    amplitude *= 0.5;\n    frequency *= 2;\n  }\n\n  return value / maxValue;\n};\n\nconst generateFirePolygonCoordinates = (\n  center: [number, number],\n  radiusMeters: number,\n  options: { \n    roughness?: number; \n    points?: number; \n    time?: number; \n    seed?: number;\n    growthVectors?: number[];\n    elapsedTime?: number;\n  } = {}\n) => {\n  const { \n    roughness = 0.4, \n    points = 64, \n    time = 0, \n    seed = 0,\n    growthVectors = [],\n    elapsedTime = 0\n  } = options;\n  \n  const coords: [number, number][] = [];\n  const latRadians = (center[1] * Math.PI) / 180;\n  const cosLat = Math.cos(latRadians);\n\n  // Calculate emergence factor (fire starts small and grows)\n  // Goes from 0 to 1 over first 8 seconds for slow visible emergence, then stays at 1\n  const emergenceFactor = Math.min(elapsedTime / 8, 1);\n  \n  for (let i = 0; i < points; i++) {\n    const angle = (i / points) * Math.PI * 2;\n    \n    // Get growth vector for this angle (or generate a random one)\n    const vectorIndex = Math.floor((i / points) * growthVectors.length);\n    const growthVector = growthVectors[vectorIndex] || 1.0;\n    \n    // Use static noise (not time-dependent) for stable organic edges\n    // Only use angle for variation, not time\n    const noiseValue = multiNoise(\n      Math.cos(angle) * 2,\n      Math.sin(angle) * 2,\n      seed,\n      3 // 3 octaves for smoother shapes\n    );\n    \n    // Very subtle, slow edge movement (not flicker)\n    const subtleMovement = 1 + Math.sin(angle * 5 + time * 0.5 + seed) * 0.02;\n    \n    // Combine all factors for realistic but stable fire spread\n    // - Base radius grows with time\n    // - Growth vectors create asymmetric spread (wind, terrain)\n    // - Noise creates organic, irregular edges (STABLE)\n    // - Subtle movement adds very slow dynamic changes\n    // - Emergence factor makes it start from center\n    const irregularity = 0.8 + (noiseValue * roughness * 0.8);\n    const effectiveRadius = radiusMeters * \n      emergenceFactor *    // Emerge from center\n      growthVector *       // Directional growth\n      irregularity *       // Organic variation (stable)\n      subtleMovement;      // Very subtle slow movement\n\n    const dx = Math.cos(angle) * effectiveRadius;\n    const dy = Math.sin(angle) * effectiveRadius;\n\n    const lngOffset = dx / (METERS_PER_DEGREE_LAT * cosLat);\n    const latOffset = dy / METERS_PER_DEGREE_LAT;\n\n    coords.push([center[0] + lngOffset, center[1] + latOffset]);\n  }\n\n  if (coords.length) {\n    coords.push(coords[0]);\n  }\n\n  return coords;\n};\n\nconst createFireFeature = (\n  incident: WildfireIncident,\n  radiusMeters: number,\n  options: { \n    time?: number; \n    roughness?: number; \n    seed?: number; \n    intensity?: number; \n    points?: number;\n    growthVectors?: number[];\n    elapsedTime?: number;\n  } = {}\n): Feature<GeoJSON.Polygon, FireFeatureProperties> => {\n  const { \n    time = 0, \n    roughness = 0.4, \n    seed = 0, \n    intensity = 0.6, \n    points = 64,\n    growthVectors = [],\n    elapsedTime = 0\n  } = options;\n\n  return {\n    type: 'Feature',\n    properties: {\n      id: typeof incident.id === 'number' ? incident.id : parseInt(String(incident.id), 10),\n      intensity,\n      name: incident.name\n    },\n    geometry: {\n      type: 'Polygon',\n      coordinates: [generateFirePolygonCoordinates(\n        incident.coordinates as [number, number], \n        radiusMeters, \n        { roughness, time, seed, points, growthVectors, elapsedTime }\n      )]\n    }\n  };\n};\n\ninterface CaliforniaMapProps {\n  className?: string;\n  onMapReady?: (navigateToIncident: (incident: Incident) => void) => void;\n  onMapMove?: (center: { lat: number; lon: number }) => void;\n  windSpeed?: number;      // Wind speed in mph\n  windDirection?: number;  // Wind direction in degrees (meteorological: where wind comes FROM)\n  onIncidentSelect?: (incident: Incident) => void;\n  onUnitUpdate?: (units: { available: number; dispatched: number; active: number }, activeUnits?: any[]) => void;\n  refreshUnitTrigger?: number; // Trigger to refresh unit data\n  selectedIncidentId?: string | null; // Currently selected incident ID\n  // Backward compatibility\n  onResponderUpdate?: (responders: { available: number; dispatched: number; active: number }, activeResponders?: any[]) => void;\n  refreshResponderTrigger?: number;\n}\n\nexport default function CaliforniaMap({ className = '', onMapReady, onMapMove, windSpeed = 10, windDirection = 270, onIncidentSelect, onUnitUpdate, refreshUnitTrigger, selectedIncidentId, onResponderUpdate, refreshResponderTrigger }: CaliforniaMapProps) {\n  // Support both new and old prop names\n  const unitUpdateCallback = onUnitUpdate || onResponderUpdate;\n  const refreshTrigger = refreshUnitTrigger || refreshResponderTrigger;\n  const mapContainerRef = useRef<HTMLDivElement>(null);\n  const mapRef = useRef<mapboxgl.Map | null>(null);\n  const markersRef = useRef<mapboxgl.Marker[]>([]);\n  const popupRef = useRef<mapboxgl.Popup | null>(null);\n  const fireStateRef = useRef<Record<number, FireState>>({});\n  const fireAnimationRef = useRef<number | null>(null);\n  const fireStartTimeRef = useRef<number | null>(null);\n  \n  // State for Supabase incidents\n  const [incidents, setIncidents] = useState<WildfireIncident[]>([]);\n  const [firestations, setFirestations] = useState<SupabaseFirestation[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [aiRecommendedRoutes, setAiRecommendedRoutes] = useState<any[]>([]);\n  const [evacuationZones, setEvacuationZones] = useState<any[]>([]);\n  const [selectedFireId, setSelectedFireId] = useState<number | null>(null);\n  const [responders, setResponders] = useState<Responder[]>([]);\n  const latestRespondersRef = useRef<Responder[]>([]); // Tracks latest responders state for fire animation\n  const responderAnimationRef = useRef<number | null>(null);\n  \n  const activeIncidents = incidents.filter((incident) => incident.status === 'active');\n  const fireSourceId = 'fire-zones';\n  const fireLayerId = 'fire-heat';\n  const routeSourceId = 'route-source';\n  const routeLayerId = 'route-layer';\n  const routeArrowLayerId = 'route-arrows';\n  const aiRouteSourceId = 'ai-route-source';\n  const aiRouteLayerId = 'ai-route-layer';\n  const evacuationSourceId = 'evacuation-source';\n  const evacuationLayerId = 'evacuation-layer';\n\n  // Function to fetch and display route from fire station to fire\n  const displayRouteToFire = useCallback(async (\n    fireLat: number,\n    fireLon: number,\n    stationLat: number,\n    stationLon: number\n  ) => {\n    if (!mapRef.current) return;\n\n    try {\n      // Fetch route from Mapbox Directions API\n      const url = `https://api.mapbox.com/directions/v5/mapbox/driving/${stationLon},${stationLat};${fireLon},${fireLat}?geometries=geojson&access_token=${mapboxgl.accessToken}`;\n      \n      const response = await fetch(url);\n      const data = await response.json();\n\n      if (data.routes && data.routes.length > 0) {\n        const route = data.routes[0].geometry;\n\n        // Remove existing route if any\n        const map = mapRef.current;\n        if (map.getLayer(routeArrowLayerId)) {\n          map.removeLayer(routeArrowLayerId);\n        }\n        if (map.getLayer(routeLayerId)) {\n          map.removeLayer(routeLayerId);\n        }\n        if (map.getSource(routeSourceId)) {\n          map.removeSource(routeSourceId);\n        }\n\n        // Add the route as a source\n        map.addSource(routeSourceId, {\n          type: 'geojson',\n          data: {\n            type: 'Feature',\n            properties: {},\n            geometry: route\n          }\n        });\n\n        // Add the route layer\n        map.addLayer({\n          id: routeLayerId,\n          type: 'line',\n          source: routeSourceId,\n          layout: {\n            'line-join': 'round',\n            'line-cap': 'round'\n          },\n          paint: {\n            'line-color': '#3b82f6', // Blue color for route\n            'line-width': 6,\n            'line-opacity': 0.8\n          }\n        });\n\n        // Add animated arrow layer to show direction\n        map.addLayer({\n          id: routeArrowLayerId,\n          type: 'line',\n          source: routeSourceId,\n          layout: {\n            'line-join': 'round',\n            'line-cap': 'round'\n          },\n          paint: {\n            'line-color': '#60a5fa', // Lighter blue for arrows\n            'line-width': 3,\n            'line-opacity': 0.6,\n            'line-dasharray': [0, 2, 2]\n          }\n        });\n      }\n    } catch (error) {\n      console.error('Error fetching route:', error);\n    }\n  }, []);\n\n  // Define navigation function for incident selection\n  const navigateToIncident = useCallback((incident: Incident) => {\n    if (!mapRef.current) return;\n    \n    const lat = incident.lat;\n    const lon = incident.lon;\n    \n    if (!lat || !lon || isNaN(lat) || isNaN(lon)) {\n      console.warn('Invalid incident coordinates:', { lat, lon, incident });\n      return;\n    }\n\n    // Set selected fire ID\n    const fireId = typeof incident.id === 'string' ? parseInt(incident.id) : incident.id;\n    setSelectedFireId(fireId);\n\n    // Notify parent component that this incident was selected\n    if (onIncidentSelect) {\n      onIncidentSelect(incident);\n    }\n    \n    // Find nearest fire station and display route (for active incidents)\n    const nearestStation = findNearestFirestation(lat, lon, firestations);\n    if (nearestStation) {\n      displayRouteToFire(lat, lon, nearestStation.lat, nearestStation.lon);\n    }\n\n    // First, remove any existing popup\n    if (popupRef.current) {\n      popupRef.current.remove();\n      popupRef.current = null;\n    }\n\n    // Convert Incident to WildfireIncident for popup content\n    const wildfireIncident: WildfireIncident = {\n      id: typeof incident.id === 'string' ? parseInt(incident.id) : incident.id,\n      name: incident.name || 'Unnamed Fire',\n      status: 'active',\n      intensity: incident.risk || 'low',\n      coordinates: [lon, lat],\n      containment: incident.containment || undefined,\n      description: incident.description || undefined\n    };\n\n    // Create the popup immediately so sidebar clicks show content without delay\n    try {\n      const popupContent = createPopupContent(wildfireIncident);\n\n      const isPalace = (wildfireIncident.name || '').toLowerCase().includes('palace of fine arts');\n      const sidebarOffset = isPalace ? 56 : 28; // push lower to avoid header overlap for Palace\n\n      popupRef.current = new mapboxgl.Popup({ \n        closeButton: true, \n        closeOnClick: true,\n        maxWidth: '380px',\n        offset: sidebarOffset,\n        anchor: 'bottom'\n      })\n        .setLngLat([lon, lat])\n        .setHTML(popupContent)\n        .addTo(mapRef.current);\n\n      // Wire up fullscreen behavior\n      try {\n        const popupNode = popupRef.current?.getElement();\n        if (popupNode) {\n          const content = popupNode.querySelector('.mapboxgl-popup-content') as HTMLElement | null;\n          const videoEl = content?.querySelector('video[data-video-element=\"true\"]') as HTMLVideoElement | null;\n          // Toggle play/pause when clicking anywhere inside popup when video exists\n          if (videoEl && content) {\n            content.onclick = (e: MouseEvent) => {\n              const target = e.target as HTMLElement;\n              // Ignore clicks on the fullscreen button itself\n              if (target.closest('button[data-fullscreen-toggle=\"true\"]')) return;\n              if (videoEl.paused) videoEl.play(); else videoEl.pause();\n            };\n          }\n          // Remove fullscreen behavior entirely\n        }\n      } catch {}\n    } catch (error) {\n      console.error('Error creating popup:', error);\n    }\n\n    // Then fly to the incident location (popup will reposition automatically)\n    mapRef.current.flyTo({\n      center: [lon, lat],\n      zoom: 17,\n      pitch: 60,\n      bearing: mapRef.current.getBearing(),\n      duration: 3500,\n      padding: { top: 260, bottom: 40, left: 40, right: 40 },\n      essential: true\n    });\n  }, [onIncidentSelect, firestations, displayRouteToFire]);\n\n  // Fetch incidents and firestations from Supabase\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        // Fetch incidents\n        const { data: incidentsData, error: incidentsError } = await supabase\n          .from('incidents')\n          .select('*')\n          .order('last_update', { ascending: false });\n\n        if (incidentsError) {\n          setError(incidentsError.message);\n          return;\n        }\n\n        // Fetch police stations (try police_stations first, fallback to firestations for backward compatibility)\n        const { data: policeStationsData, error: policeStationsError } = await supabase\n          .from('police_stations')\n          .select('*')\n          .order('id');\n        \n        // Fallback to firestations if police_stations doesn't exist\n        let firestationsData = policeStationsData;\n        let firestationsError = policeStationsError;\n        if (policeStationsError && policeStationsError.code === 'PGRST116') {\n          const { data: fallbackData, error: fallbackError } = await supabase\n            .from('firestations')\n            .select('*')\n            .order('id');\n          firestationsData = fallbackData;\n          firestationsError = fallbackError;\n        }\n\n        if (firestationsError) {\n          console.error('Error fetching police stations:', firestationsError);\n        }\n\n        const convertedIncidents = (incidentsData || []).map(convertSupabaseIncident);\n        setIncidents(convertedIncidents);\n        setFirestations(firestationsData || []);\n        setLoading(false);\n      } catch (err) {\n        setError('Failed to fetch data');\n        setLoading(false);\n      }\n    };\n\n    fetchData();\n\n    // Set up real-time updates\n    const channel = supabase\n      .channel('incidents-rt')\n      .on('postgres_changes',\n        { event: '*', schema: 'public', table: 'incidents' },\n        (payload) => {\n          const newIncident = payload.new as SupabaseIncident;\n          const convertedIncident = convertSupabaseIncident(newIncident);\n          \n          setIncidents(prev => {\n            const without = prev.filter(i => i.id !== convertedIncident.id);\n            return [convertedIncident, ...without];\n          });\n        })\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, []);\n\n  // Poll for AI-recommended routes and evacuations\n  useEffect(() => {\n    const pollRoutes = async () => {\n      try {\n        const response = await fetch('/api/update-routes');\n        if (!response.ok) {\n          console.warn('Failed to fetch AI routes:', response.statusText);\n          return;\n        }\n        \n        const data = await response.json();\n        setAiRecommendedRoutes(data.routes || []);\n        setEvacuationZones(data.evacuations || []);\n        \n        if (data.routes && data.routes.length > 0) {\n          console.log(`[AI Agent] Received ${data.routes.length} route updates`);\n        }\n      } catch (error) {\n        console.error('Error polling AI routes:', error);\n      }\n    };\n    \n    // Initial poll\n    pollRoutes();\n    \n    // Poll every 30 seconds\n    const interval = setInterval(pollRoutes, 30000);\n    \n    return () => clearInterval(interval);\n  }, []);\n\n  // Poll for active units and update their positions\n  useEffect(() => {\n    const pollUnits = async () => {\n      try {\n        const response = await fetch('/api/dispatch-unit');\n        if (!response.ok) return;\n        \n        const data = await response.json();\n        \n        // Update unit stats - pass active units so parent can filter by incident\n        if (unitUpdateCallback && data.totals) {\n          unitUpdateCallback(\n            {\n              available: data.totals.available || 0,\n              dispatched: data.totals.dispatched || 0,\n              active: data.totals.on_scene || data.totals.active || 0\n            },\n            data.activeUnits || data.activeResponders || []\n          );\n        }\n        \n        // Update active units state (support both activeUnits and activeResponders for backward compatibility)\n        const activeUnitsData = data.activeUnits || data.activeResponders || [];\n        if (activeUnitsData.length > 0) {\n          const newUnits = activeUnitsData.map((dbUnit: any) => ({\n            id: dbUnit.id,\n            station_id: dbUnit.station_id || dbUnit.firestation_id,\n            firestation_id: dbUnit.firestation_id || dbUnit.station_id, // Backward compatibility\n            incident_id: dbUnit.incident_id,\n            unit_number: dbUnit.unit_number,\n            team_number: dbUnit.team_number || parseInt(dbUnit.unit_number?.match(/\\d+/)?.[0] || '1'), // Extract number from unit_number\n            status: dbUnit.status,\n            current_lat: dbUnit.current_lat,\n            current_lon: dbUnit.current_lon,\n            dispatched_at: dbUnit.dispatched_at,\n            progress: 0\n          }));\n          setResponders(newUnits as Responder[]);\n          latestRespondersRef.current = newUnits as Responder[];\n        } else {\n          setResponders([]);\n          latestRespondersRef.current = [];\n        }\n      } catch (error) {\n        console.error('Error polling units:', error);\n      }\n    };\n    \n    // Initial poll\n    pollUnits();\n    \n    // Poll every 5 seconds for active units\n    const interval = setInterval(pollUnits, 5000);\n    \n    return () => clearInterval(interval);\n  }, [refreshTrigger, unitUpdateCallback]);\n\n  // Animate responders moving along routes\n  useEffect(() => {\n    if (!mapRef.current) return;\n    \n    const map = mapRef.current;\n    \n    if (responders.length === 0) {\n      console.log('[Responder Animation] No responders to animate');\n      return;\n    }\n    \n    console.log('[Responder Animation] Starting animation for', responders.length, 'responders');\n\n    let animationFrameId: number;\n    const respondersRef: Responder[] = responders.map(r => ({...r})); // Copy to avoid state mutation\n\n    const animateResponders = async () => {\n      for (const responder of respondersRef) {\n        // Check if this responder's incident is selected\n        const isIncidentSelected = selectedIncidentId && String(responder.incident_id) === String(selectedIncidentId);\n        \n        // If responder doesn't have a marker yet, create one\n        if (!responder.marker) {\n          console.log(`[Marker] Creating marker for Team ${responder.team_number} at [${responder.current_lon}, ${responder.current_lat}]`);\n          const markerEl = createFiretruckMarker(responder.team_number);\n          const marker = new mapboxgl.Marker({ element: markerEl, anchor: 'center' })\n            .setLngLat([responder.current_lon, responder.current_lat])\n            .addTo(map);\n          \n          // Hide by default (only show when incident is selected)\n          markerEl.style.display = isIncidentSelected ? 'block' : 'none';\n          \n          responder.marker = marker;\n        } else {\n          // Update visibility based on selection\n          const markerEl = responder.marker.getElement();\n          if (markerEl) {\n            markerEl.style.display = isIncidentSelected ? 'block' : 'none';\n          }\n        }\n\n        // If responder doesn't have a route yet and is dispatched, fetch it\n        if (!responder.route && (responder.status === 'dispatched' || responder.status === 'en_route')) {\n          const incident = incidents.find(i => String(i.id) === String(responder.incident_id));\n          console.log(`[Route] Team ${responder.team_number} - Looking for incident ${responder.incident_id}, found:`, !!incident);\n          \n          if (incident) {\n            try {\n              const mapboxToken = 'pk.eyJ1Ijoic3BhbnVnYW50aTMxIiwiYSI6ImNtaDVwbzBlYzA1bTkybnB6azQxZnEwOGEifQ.eCNufvFartJqVo8Nwkwkeg';\n              const [fireLon, fireLat] = incident.coordinates;\n              // Validate responder position\n              if (isNaN(responder.current_lon) || isNaN(responder.current_lat)) {\n                console.error(`[Route] âŒ Invalid responder position for Team ${responder.team_number}:`, {\n                  lat: responder.current_lat,\n                  lon: responder.current_lon\n                });\n                continue;\n              }\n              \n              // Validate fire position\n              if (isNaN(fireLon) || isNaN(fireLat)) {\n                console.error(`[Route] âŒ Invalid fire position for incident ${responder.incident_id}:`, {\n                  lat: fireLat,\n                  lon: fireLon\n                });\n                continue;\n              }\n              \n              const routeUrl = `https://api.mapbox.com/directions/v5/mapbox/driving/${responder.current_lon},${responder.current_lat};${fireLon},${fireLat}?geometries=geojson&access_token=${mapboxToken}`;\n              \n              console.log(`[Route] Fetching route for Team ${responder.team_number} from [${responder.current_lon}, ${responder.current_lat}] to [${fireLon}, ${fireLat}]`);\n              const response = await fetch(routeUrl);\n              const data = await response.json();\n              \n              // Check for Mapbox API errors\n              if (data.code && data.code !== 'Ok') {\n                console.error(`[Route] âŒ Mapbox API error for Team ${responder.team_number}:`, data);\n                continue;\n              }\n              \n              if (data.routes && data.routes.length > 0) {\n                const geometry = data.routes[0].geometry;\n                \n                // Validate geometry structure\n                if (!geometry || !geometry.coordinates || !Array.isArray(geometry.coordinates) || geometry.coordinates.length === 0) {\n                  console.error(`[Route] âŒ Invalid route geometry for Team ${responder.team_number}:`, geometry);\n                  continue;\n                }\n                \n                // Validate first few coordinates to ensure they're valid numbers\n                const coords = geometry.coordinates;\n                let hasInvalidCoords = false;\n                for (let i = 0; i < Math.min(3, coords.length); i++) {\n                  const coord = coords[i];\n                  if (!coord || !Array.isArray(coord) || coord.length < 2 || \n                      isNaN(coord[0]) || isNaN(coord[1])) {\n                    console.error(`[Route] âŒ Invalid coordinate at index ${i} for Team ${responder.team_number}:`, coord);\n                    hasInvalidCoords = true;\n                    break;\n                  }\n                }\n                \n                if (hasInvalidCoords) {\n                  console.error(`[Route] âŒ Skipping invalid route for Team ${responder.team_number}`);\n                  continue;\n                }\n                \n                responder.route = geometry;\n                responder.progress = 0;\n                console.log(`[Route] âœ… Route fetched for Team ${responder.team_number}, ${responder.route.coordinates.length} points, duration: ${Math.round(data.routes[0].duration / 60)} min`);\n                \n                // Add route to map as blue line (only if map style is loaded)\n                if (map && map.isStyleLoaded && map.isStyleLoaded()) {\n                  try {\n                    const routeSourceId = `responder-route-${responder.id}`;\n                    const routeLayerId = `responder-route-layer-${responder.id}`;\n                    \n                    // Remove existing route if any\n                    if (map.getLayer && map.getLayer(routeLayerId)) {\n                      map.removeLayer(routeLayerId);\n                    }\n                    if (map.getSource && map.getSource(routeSourceId)) {\n                      map.removeSource(routeSourceId);\n                    }\n                    \n                    // Add route source and layer\n                    if (map.addSource && map.addLayer) {\n                      map.addSource(routeSourceId, {\n                        type: 'geojson',\n                        data: {\n                          type: 'Feature',\n                          properties: {},\n                          geometry: responder.route\n                        }\n                      });\n                      \n                      map.addLayer({\n                        id: routeLayerId,\n                        type: 'line',\n                        source: routeSourceId,\n                        layout: {\n                          'line-join': 'round',\n                          'line-cap': 'round'\n                        },\n                        paint: {\n                          'line-color': '#3b82f6', // Blue color for route\n                          'line-width': 4,\n                          'line-opacity': 0.8\n                        }\n                      });\n                    }\n                  } catch (error) {\n                    console.error(`[Route] Error adding route to map:`, error);\n                  }\n                }\n                \n                // Update status to en_route if not already\n                if (responder.status === 'dispatched') {\n                  // Try units table first, fallback to responders for backward compatibility\n                  const updateTable = async () => {\n                    try {\n                      await supabase.from('units').update({ status: 'en_route' }).eq('id', responder.id);\n                    } catch {\n                      await supabase.from('responders').update({ status: 'en_route' }).eq('id', responder.id);\n                    }\n                  };\n                  await updateTable();\n                  responder.status = 'en_route';\n                  console.log(`[Route] Updated Team ${responder.team_number} status to en_route`);\n                }\n              } else {\n                console.error(`[Route] âŒ No routes found in response for Team ${responder.team_number}`);\n              }\n            } catch (error) {\n              console.error(`[Route] âŒ Error fetching route for Team ${responder.team_number}:`, error);\n            }\n          } else {\n            console.warn(`[Route] âš ï¸ Could not find incident ${responder.incident_id} for Team ${responder.team_number}`);\n          }\n        }\n\n        // Animate responder along route\n        if (responder.route && (responder.status === 'en_route' || responder.status === 'dispatched') && responder.progress !== undefined) {\n          // Move at a steady pace (complete route in 10 seconds)\n          responder.progress = Math.min(responder.progress + (1 / (10 * 60)), 1); // 60fps, 10 seconds total\n\n          // Validate route structure\n          if (!responder.route || typeof responder.route !== 'object') {\n            console.error(`[Animation] Invalid route object for Team ${responder.team_number}:`, responder.route);\n            continue;\n          }\n\n          const coordinates = responder.route.coordinates;\n          if (!coordinates || !Array.isArray(coordinates) || coordinates.length === 0) {\n            console.error(`[Animation] Invalid route coordinates for Team ${responder.team_number}:`, {\n              hasCoordinates: !!coordinates,\n              isArray: Array.isArray(coordinates),\n              length: coordinates?.length,\n              route: responder.route\n            });\n            continue;\n          }\n\n          // Validate first coordinate\n          if (!coordinates[0] || !Array.isArray(coordinates[0]) || coordinates[0].length < 2) {\n            console.error(`[Animation] Invalid coordinate format for Team ${responder.team_number}:`, coordinates[0]);\n            continue;\n          }\n\n          const currentPos = getPointAlongLine(coordinates, responder.progress);\n          \n          // Validate calculated position\n          if (!currentPos || !Array.isArray(currentPos) || isNaN(currentPos[0]) || isNaN(currentPos[1])) {\n            console.error(`[Animation] Invalid calculated position for Team ${responder.team_number}:`, {\n              currentPos,\n              progress: responder.progress,\n              coordCount: coordinates.length,\n              firstCoord: coordinates[0],\n              lastCoord: coordinates[coordinates.length - 1]\n            });\n            continue;\n          }\n\n          // Update marker position\n          if (responder.marker) {\n            responder.marker.setLngLat(currentPos);\n            \n            // Log less frequently - only every 10%\n            if (Math.abs((responder.progress * 100) % 10) < 2) {\n              console.log(`[Animation] Team ${responder.team_number} at ${Math.round(responder.progress * 100)}% progress`);\n            }\n          }\n\n          // CHECK FOR FIRE COLLISION WHILE MOVING\n          const incident = incidents.find(i => String(i.id) === String(responder.incident_id));\n          if (incident && responder.status === 'en_route') {\n            const [fireLon, fireLat] = incident.coordinates;\n            const [truckLon, truckLat] = currentPos;\n            \n            // Get fire state to calculate ACTUAL current fire radius\n            const incidentKey = typeof incident.id === 'number' ? incident.id : parseInt(String(incident.id), 10);\n            const fireState = fireStateRef.current[incidentKey];\n            if (fireState) {\n              // Calculate the current radius multiplier (same logic as in animateFire)\n              const now = Date.now();\n              const elapsedSeconds = (now - (fireState.startTime || now)) / 1000;\n              \n              // Check if other responders are already on scene\n              const othersOnScene = latestRespondersRef.current.filter(\n                r => String(r.incident_id) === String(incident.id) && r.status === 'on_scene' && r.id !== responder.id\n              ).length;\n              \n              let currentRadiusMultiplier = 1.0;\n              if (othersOnScene > 0 && fireState.containmentStartTime) {\n                // Fire is already being contained\n                const containmentSeconds = (now - fireState.containmentStartTime) / 1000;\n                const shrinkProgress = Math.min(containmentSeconds / (20 / othersOnScene), 1);\n                currentRadiusMultiplier = 1 - (shrinkProgress * 0.95);\n              } else {\n                // Fire is still growing\n                const growthProgress = Math.min(elapsedSeconds / 240, 1);\n                const easedGrowth = 1 - Math.pow(1 - growthProgress, 1.8);\n                const pulse = Math.sin(elapsedSeconds * fireState.waveSpeed + fireState.seed) * 0.01;\n                currentRadiusMultiplier = 0.02 + (easedGrowth * 0.98) + pulse;\n              }\n              \n              const currentRadius = fireState.baseRadius * currentRadiusMultiplier;\n              \n              // Calculate distance from truck to fire center\n              const distanceKm = calculateDistance(truckLat, truckLon, fireLat, fireLon);\n              const distanceMeters = distanceKm * 1000;\n              \n              // If truck touches fire edge, STOP and mark as on_scene immediately!\n              if (distanceMeters <= currentRadius + 50) {\n                responder.status = 'on_scene';\n                responder.progress = 1; // Stop movement\n                \n                // Try units table first, fallback to responders for backward compatibility\n                const updateOnScene = async () => {\n                  try {\n                    await supabase.from('units').update({\n                      status: 'on_scene',\n                      arrived_at: new Date().toISOString(),\n                      current_lat: truckLat,\n                      current_lon: truckLon\n                    }).eq('id', responder.id);\n                  } catch {\n                    await supabase.from('responders').update({\n                      status: 'on_scene',\n                      arrived_at: new Date().toISOString(),\n                      current_lat: truckLat,\n                      current_lon: truckLon\n                    }).eq('id', responder.id);\n                  }\n                };\n                await updateOnScene();\n                \n                // CRITICAL: Update React state AND ref immediately\n                setResponders(prev => {\n                  const updated = prev.map(r => \n                    r.id === responder.id \n                      ? { ...r, status: 'on_scene' as const }\n                      : r\n                  );\n                  latestRespondersRef.current = updated;\n                  return updated;\n                });\n                \n                // Remove route from map\n                if (map && map.isStyleLoaded && map.isStyleLoaded()) {\n                  try {\n                    const routeSourceId = `responder-route-${responder.id}`;\n                    const routeLayerId = `responder-route-layer-${responder.id}`;\n                    if (map.getLayer && map.getLayer(routeLayerId)) {\n                      map.removeLayer(routeLayerId);\n                    }\n                    if (map.getSource && map.getSource(routeSourceId)) {\n                      map.removeSource(routeSourceId);\n                    }\n                  } catch (error) {\n                    console.error(`[Route] Error removing route from map:`, error);\n                  }\n                }\n                \n                console.log(`[Responder] âœ… Team ${responder.team_number} TOUCHED FIRE EDGE at ${distanceMeters.toFixed(0)}m from center! ON SCENE`);\n                console.log(`[Responder] ðŸ”¥ Fire radius: ${currentRadius.toFixed(0)}m - Beginning suppression operations!`);\n                \n                // Skip the rest of the animation for this responder\n                continue;\n              }\n            }\n          }\n\n          // Update current position in database every 5 seconds\n          if (Math.random() < 0.012) { // ~5 seconds at 60fps\n            // Try units table first, fallback to responders for backward compatibility\n            const updatePosition = async () => {\n              try {\n                await supabase.from('units').update({\n                  current_lat: currentPos[1],\n                  current_lon: currentPos[0]\n                }).eq('id', responder.id);\n              } catch {\n                await supabase.from('responders').update({\n                  current_lat: currentPos[1],\n                  current_lon: currentPos[0]\n                }).eq('id', responder.id);\n              }\n            };\n            updatePosition();\n          }\n\n          // When responder reaches destination, keep them en_route until they touch the fire\n          if (responder.progress >= 1 && responder.status === 'dispatched') {\n            responder.status = 'en_route';\n            \n            // Update database to en_route\n            const updateToEnRoute = async () => {\n              try {\n                await supabase.from('units').update({ status: 'en_route' }).eq('id', responder.id);\n              } catch {\n                await supabase.from('responders').update({ status: 'en_route' }).eq('id', responder.id);\n              }\n            };\n            await updateToEnRoute();\n            \n            console.log(`[Responder] Team ${responder.team_number} arrived at fire location, approaching fire edge...`);\n            \n            // Remove route from map when arrived at location\n            if (map && map.isStyleLoaded && map.isStyleLoaded()) {\n              try {\n                const routeSourceId = `responder-route-${responder.id}`;\n                const routeLayerId = `responder-route-layer-${responder.id}`;\n                if (map.getLayer && map.getLayer(routeLayerId)) {\n                  map.removeLayer(routeLayerId);\n                }\n                if (map.getSource && map.getSource(routeSourceId)) {\n                  map.removeSource(routeSourceId);\n                }\n              } catch (error) {\n                console.error(`[Route] Error removing route from map:`, error);\n              }\n            }\n          }\n          \n          // FALLBACK: Check if responder touches fire edge (after reaching destination)\n          // This should rarely trigger since we check during movement above\n          if (responder.progress >= 1 && responder.status === 'en_route') {\n            const incident = incidents.find(i => String(i.id) === String(responder.incident_id));\n            if (incident) {\n              const [fireLon, fireLat] = incident.coordinates;\n              const [truckLon, truckLat] = responder.marker?.getLngLat ? [responder.marker.getLngLat().lng, responder.marker.getLngLat().lat] : [fireLon, fireLat];\n              \n              // Get fire state to calculate ACTUAL current fire radius\n              const incidentKey = typeof incident.id === 'number' ? incident.id : parseInt(String(incident.id), 10);\n              const fireState = fireStateRef.current[incidentKey];\n              if (fireState) {\n                // Calculate the current radius multiplier (same logic as in animateFire)\n                const now = Date.now();\n                const elapsedSeconds = (now - (fireState.startTime || now)) / 1000;\n                \n                // Check if other responders are already on scene (use ref for latest value)\n                const othersOnScene = latestRespondersRef.current.filter(\n                  r => String(r.incident_id) === String(incident.id) && r.status === 'on_scene' && r.id !== responder.id\n                ).length;\n                \n                let currentRadiusMultiplier = 1.0;\n                if (othersOnScene > 0 && fireState.containmentStartTime) {\n                  // Fire is already being contained\n                  const containmentSeconds = (now - fireState.containmentStartTime) / 1000;\n                  const shrinkProgress = Math.min(containmentSeconds / (20 / othersOnScene), 1);\n                  currentRadiusMultiplier = 1 - (shrinkProgress * 0.95);\n                } else {\n                  // Fire is still growing\n                  const growthProgress = Math.min(elapsedSeconds / 240, 1);\n                  const easedGrowth = 1 - Math.pow(1 - growthProgress, 1.8);\n                  const pulse = Math.sin(elapsedSeconds * fireState.waveSpeed + fireState.seed) * 0.01;\n                  currentRadiusMultiplier = 0.02 + (easedGrowth * 0.98) + pulse;\n                }\n                \n                const currentRadius = fireState.baseRadius * currentRadiusMultiplier;\n                \n                // Calculate distance from truck to fire center\n                const distanceKm = calculateDistance(truckLat, truckLon, fireLat, fireLon);\n                const distanceMeters = distanceKm * 1000;\n                \n                console.log(`[Responder] Team ${responder.team_number} distance to fire: ${distanceMeters.toFixed(0)}m, fire radius: ${currentRadius.toFixed(0)}m`);\n                \n                // If truck is within fire radius + 50m buffer (touching fire edge)\n                if (distanceMeters <= currentRadius + 50) {\n                  responder.status = 'on_scene';\n                  \n                  const updateToOnScene = async () => {\n                    try {\n                      await supabase.from('units').update({\n                        status: 'on_scene',\n                        arrived_at: new Date().toISOString()\n                      }).eq('id', responder.id);\n                    } catch {\n                      await supabase.from('responders').update({\n                        status: 'on_scene',\n                        arrived_at: new Date().toISOString()\n                      }).eq('id', responder.id);\n                    }\n                  };\n                  await updateToOnScene();\n                  \n                  // CRITICAL: Update React state AND ref immediately so fire animation sees the responder on scene\n                  setResponders(prev => {\n                    const updated = prev.map(r => \n                      r.id === responder.id \n                        ? { ...r, status: 'on_scene' as const }\n                        : r\n                    );\n                    latestRespondersRef.current = updated;\n                    return updated;\n                  });\n                  \n                  console.log(`[Responder] âœ… Team ${responder.team_number} made contact with fire! ON SCENE`);\n                  console.log(`[Responder] ðŸ”¥ Beginning fire suppression operations`);\n                }\n              }\n            }\n          }\n        }\n      }\n\n      animationFrameId = requestAnimationFrame(animateResponders);\n    };\n\n    animateResponders();\n\n    return () => {\n      console.log('[Responder Animation] Cleanup');\n      if (animationFrameId) {\n        cancelAnimationFrame(animationFrameId);\n      }\n      \n      // Clean up markers and routes\n      respondersRef.forEach(r => {\n        if (r.marker) {\n          try {\n            r.marker.remove();\n          } catch (error) {\n            console.error('Error removing marker:', error);\n          }\n        }\n        // Clean up route layers\n        if (map && map.isStyleLoaded && map.isStyleLoaded()) {\n          try {\n            const routeSourceId = `responder-route-${r.id}`;\n            const routeLayerId = `responder-route-layer-${r.id}`;\n            if (map.getLayer && map.getLayer(routeLayerId)) {\n              map.removeLayer(routeLayerId);\n            }\n            if (map.getSource && map.getSource(routeSourceId)) {\n              map.removeSource(routeSourceId);\n            }\n          } catch (error) {\n            console.error('Error cleaning up route:', error);\n          }\n        }\n      });\n    };\n  }, [responders, incidents, selectedIncidentId, firestations, unitUpdateCallback]);\n\n  // Update AI routes and evacuation zones on map\n  useEffect(() => {\n    const map = mapRef.current;\n    if (!map || !map.isStyleLoaded()) return;\n\n    // Wait for map to be fully loaded with all sources\n    const updateSources = () => {\n      try {\n        // Update AI routes only if source exists\n        if (map.getSource(aiRouteSourceId)) {\n          const aiSource = map.getSource(aiRouteSourceId) as mapboxgl.GeoJSONSource;\n          if (aiSource && typeof aiSource.setData === 'function') {\n            const routeFeatures = aiRecommendedRoutes.map((route: any) => ({\n              type: 'Feature' as const,\n              properties: {\n                station_id: route.station_id,\n                reason: route.reason,\n                risk_score: route.risk_score\n              },\n              geometry: route.new_route?.geometry || {\n                type: 'LineString' as const,\n                coordinates: route.new_route?.waypoints || []\n              }\n            }));\n\n            aiSource.setData({\n              type: 'FeatureCollection',\n              features: routeFeatures\n            });\n          }\n        }\n\n        // Update evacuation zones only if source exists\n        if (map.getSource(evacuationSourceId)) {\n          const evacSource = map.getSource(evacuationSourceId) as mapboxgl.GeoJSONSource;\n          if (evacSource && typeof evacSource.setData === 'function') {\n            const evacuationFeatures = evacuationZones.map((zone: any) => ({\n              type: 'Feature' as const,\n              properties: {\n                fire_id: zone.fire_id,\n                zone_name: zone.zone_name\n              },\n              geometry: {\n                type: 'Polygon' as const,\n                coordinates: [zone.polygon || []]\n              }\n            }));\n\n            evacSource.setData({\n              type: 'FeatureCollection',\n              features: evacuationFeatures\n            });\n          }\n        }\n      } catch (error) {\n        console.error('Error updating map sources:', error);\n      }\n    };\n\n    // If map is already loaded, update immediately\n    if (map.loaded()) {\n      updateSources();\n    } else {\n      // Otherwise wait for load event\n      map.once('load', updateSources);\n    }\n  }, [aiRecommendedRoutes, evacuationZones]);\n\n  useEffect(() => {\n    if (!mapContainerRef.current || loading) return;\n\n    // Set Mapbox access token\n    mapboxgl.accessToken = 'pk.eyJ1Ijoic3BhbnVnYW50aTMxIiwiYSI6ImNtaDVwbzBlYzA1bTkybnB6azQxZnEwOGEifQ.eCNufvFartJqVo8Nwkwkeg';\n\n    // Initialize map\n    mapRef.current = new mapboxgl.Map({\n      container: mapContainerRef.current,\n      style: 'mapbox://styles/mapbox/dark-v11',\n      center: [-122.0, 38.5],\n      zoom: 7.5,\n      pitch: 45,\n      bearing: 0,\n      attributionControl: false\n    });\n\n    const map = mapRef.current;\n\n    // Navigation and fullscreen controls removed per user request\n    \n    // Add scale control\n    map.addControl(new mapboxgl.ScaleControl({ maxWidth: 100, unit: 'imperial' }), 'bottom-left');\n\n    // Emit initial map center\n    if (onMapMove) {\n      const center = map.getCenter();\n      onMapMove({ lat: center.lat, lon: center.lng });\n    }\n\n    // Track map movement\n    map.on('moveend', () => {\n      if (onMapMove) {\n        const center = map.getCenter();\n        onMapMove({ lat: center.lat, lon: center.lng });\n      }\n    });\n\n    // Call onMapReady callback with navigation function\n    if (onMapReady) {\n      onMapReady(navigateToIncident);\n    }\n\n    // Wait for map to load\n    map.on('load', () => {\n    // Add terrain source\n    map.addSource('mapbox-dem', {\n      type: 'raster-dem',\n      url: 'mapbox://mapbox.terrain-rgb',\n      tileSize: 512,\n      maxzoom: 14\n    });\n\n      // Set terrain with exaggeration\n    map.setTerrain({ \n      source: 'mapbox-dem', \n      exaggeration: 1.5 \n    });\n\n    // Add 3D buildings layer\n    map.addLayer({\n      id: '3d-buildings',\n      source: 'composite',\n      'source-layer': 'building',\n      filter: ['==', 'extrude', 'true'],\n      type: 'fill-extrusion',\n      paint: {\n        'fill-extrusion-color': '#888',\n        'fill-extrusion-height': ['get', 'height'],\n        'fill-extrusion-opacity': 0.6\n      }\n    });\n\n      // Add sky layer\n    map.addLayer({\n      id: 'sky',\n      type: 'sky',\n      paint: {\n        'sky-type': 'atmosphere',\n        'sky-atmosphere-sun': [0.0, 0.0],\n        'sky-atmosphere-sun-intensity': 15\n      }\n    });\n\n      // Initialize dynamic fire polygons for active incidents\n      activeIncidents.forEach((incident) => {\n        const seed = Math.random() * Math.PI * 2;\n        \n        // Generate wind-influenced growth vectors using CURRENT wind\n        // These values will be LOCKED for this fire and won't change\n        const numVectors = 16; // Fewer directional segments for simpler shapes\n        const growthVectors = generateWindInfluencedGrowthVectors(\n          numVectors,\n          windSpeed,\n          windDirection\n        );\n        \n        const incidentKey = typeof incident.id === 'number' ? incident.id : parseInt(String(incident.id), 10);\n        fireStateRef.current[incidentKey] = {\n          baseRadius: getBaseRadiusMeters(incident) * 2.5, // Allow larger expansion (2.5x larger)\n          roughness: 0.2 + Math.random() * 0.15, // Less roughness for more stable edges\n          waveSpeed: 0.3 + Math.random() * 0.3,  // Slower wave speed\n          amplitude: 90 + Math.random() * 110,\n          expansionRate: getExpansionRate(incident),\n          seed,\n          growthVectors,\n          startTime: Date.now(), // Track when this fire started\n          initialWindSpeed: windSpeed, // Lock initial wind speed\n          initialWindDirection: windDirection // Lock initial wind direction\n        };\n      });\n\n      const initialFireFeatures: FeatureCollection<GeoJSON.Polygon, FireFeatureProperties> = {\n        type: 'FeatureCollection',\n        features: activeIncidents.map((incident) => {\n          const incidentKey = typeof incident.id === 'number' ? incident.id : parseInt(String(incident.id), 10);\n          const state = fireStateRef.current[incidentKey];\n          return createFireFeature(incident, state.baseRadius * 0.02, { // Start tiny (2% of base)\n            roughness: state.roughness,\n            seed: state.seed,\n            intensity: 0.55,\n            points: 24, // Fewer edges for simpler polygon\n            growthVectors: state.growthVectors,\n            elapsedTime: 0 // Just starting\n          });\n        })\n      };\n\n      map.addSource(fireSourceId, {\n        type: 'geojson',\n        data: initialFireFeatures\n      });\n\n      map.addLayer({\n        id: fireLayerId,\n        type: 'fill',\n        source: fireSourceId,\n        paint: {\n          'fill-color': [\n            'interpolate',\n            ['linear'],\n            ['get', 'intensity'],\n            0, 'rgba(140, 20, 0, 0.35)',      // Very dark red (core/oldest)\n            0.2, 'rgba(180, 35, 5, 0.45)',    // Deep maroon-red\n            0.35, 'rgba(200, 50, 10, 0.55)',  // Dark burnt orange\n            0.5, 'rgba(220, 70, 15, 0.65)',   // Rich orange-red\n            0.65, 'rgba(235, 90, 25, 0.7)',   // Deeper orange\n            0.8, 'rgba(245, 110, 35, 0.75)',  // Bright orange\n            1, 'rgba(255, 130, 50, 0.8)'      // Lighter orange (edges/newest)\n          ],\n          'fill-opacity': [\n            'interpolate',\n            ['linear'],\n            ['zoom'],\n            7, 0.5,    // More visible at far zoom\n            10, 0.65,  // Increased opacity\n            13, 0.75,\n            16, 0.85   // Very visible when zoomed in\n          ],\n          'fill-outline-color': 'rgba(200, 60, 0, 0.5)' // Darker orange-red outline\n        }\n      });\n\n      map.addLayer(\n        {\n          id: 'fire-glow-outline',\n          type: 'line',\n          source: fireSourceId,\n          paint: {\n            'line-color': 'rgba(240, 100, 40, 0.7)',  // Brighter orange glow for edge\n            'line-width': [\n              'interpolate',\n              ['linear'],\n              ['zoom'],\n              7, 1.5,\n              12, 3,\n              15, 5\n            ],\n            'line-blur': 4,\n            'line-opacity': 0.75\n          }\n        },\n        fireLayerId\n      );\n\n      // Add AI-recommended routes source and layer\n      map.addSource(aiRouteSourceId, {\n        type: 'geojson',\n        data: {\n          type: 'FeatureCollection',\n          features: []\n        }\n      });\n\n      map.addLayer({\n        id: aiRouteLayerId,\n        type: 'line',\n        source: aiRouteSourceId,\n        layout: {\n          'line-join': 'round',\n          'line-cap': 'round'\n        },\n        paint: {\n          'line-color': '#FF8C00', // Dark orange for AI routes\n          'line-width': 5,\n          'line-dasharray': [2, 2], // Dashed line\n          'line-opacity': 0.9\n        }\n      });\n\n      // Add evacuation zones source and layer\n      map.addSource(evacuationSourceId, {\n        type: 'geojson',\n        data: {\n          type: 'FeatureCollection',\n          features: []\n        }\n      });\n\n      map.addLayer({\n        id: evacuationLayerId,\n        type: 'fill',\n        source: evacuationSourceId,\n        paint: {\n          'fill-color': '#DC2626', // Red for evacuation zones\n          'fill-opacity': 0.15\n        }\n      });\n\n      map.addLayer({\n        id: 'evacuation-outline',\n        type: 'line',\n        source: evacuationSourceId,\n        paint: {\n          'line-color': '#DC2626',\n          'line-width': 2,\n          'line-dasharray': [4, 2],\n          'line-opacity': 0.8\n        }\n      });\n\n      const animateFire = (timestamp: number) => {\n        if (!mapRef.current) return;\n        if (fireStartTimeRef.current === null) {\n          fireStartTimeRef.current = timestamp;\n        }\n\n        const elapsedSeconds = (timestamp - fireStartTimeRef.current) / 1000;\n\n        const features = activeIncidents.map((incident) => {\n          const incidentKey = typeof incident.id === 'number' ? incident.id : parseInt(String(incident.id), 10);\n          const state = fireStateRef.current[incidentKey];\n          if (!state) {\n            return createFireFeature(incident, getBaseRadiusMeters(incident));\n          }\n\n          // Check if responders are on scene for this fire (use ref to get latest value)\n          const respondersOnScene = latestRespondersRef.current.filter(\n            r => String(r.incident_id) === String(incident.id) && r.status === 'on_scene'\n          ).length;\n\n          let radiusMultiplier = 1.0;\n\n          if (respondersOnScene > 0) {\n            // Responders are containing the fire - STOP GROWTH and start shrinking\n            if (!state.containmentStartTime) {\n              state.containmentStartTime = timestamp;\n              state.containmentRate = 0.15 * respondersOnScene; // More responders = faster containment\n              state.respondersOnScene = respondersOnScene;\n              // Lock the fire size at the moment containment starts\n              state.maxRadiusBeforeContainment = state.baseRadius * radiusMultiplier;\n              console.log(`[Fire Containment] ${respondersOnScene} responders on scene at ${incident.name}, STOPPING fire growth and beginning containment`);\n            }\n\n            const containmentSeconds = (timestamp - state.containmentStartTime) / 1000;\n            // Fire shrinks over 20 seconds per responder (fast demo)\n            const shrinkProgress = Math.min(containmentSeconds / (20 / respondersOnScene), 1);\n            \n            // Start from the locked size (when containment began) and shrink to 5%\n            // This ensures fire doesn't grow after responders arrive\n            radiusMultiplier = 1 - (shrinkProgress * 0.95);\n\n            // Update containment percentage in Supabase\n            const newContainment = Math.min(Math.floor(shrinkProgress * 100), 100);\n            if (newContainment !== incident.containment && newContainment % 10 === 0) {\n              // Update every 10% for faster updates\n              console.log(`[Fire Containment] ${incident.name} containment: ${newContainment}%`);\n              supabase\n                .from('incidents')\n                .update({ \n                  containment: newContainment,\n                  status: newContainment >= 100 ? 'contained' : 'active'\n                })\n                .eq('id', String(incident.id))\n                .then(({ error }) => {\n                  if (error) console.error('Error updating containment:', error);\n                });\n            }\n            \n            // If fully contained, return responders to available\n            if (shrinkProgress >= 1 && newContainment >= 100) {\n              console.log(`[Fire Containment] âœ… ${incident.name} fully contained!`);\n              \n              // Reset all responders on this fire back to available (use ref for latest value)\n              // Include both on_scene AND en_route responders\n              const respondersToReset = latestRespondersRef.current.filter(\n                r => String(r.incident_id) === String(incident.id) && \n                     (r.status === 'on_scene' || r.status === 'en_route' || r.status === 'dispatched')\n              );\n              \n              const onScene = respondersToReset.filter(r => r.status === 'on_scene').length;\n              const enRoute = respondersToReset.filter(r => r.status === 'en_route').length;\n              const dispatched = respondersToReset.filter(r => r.status === 'dispatched').length;\n              console.log(`[Fire Containment] ðŸš’ Returning ${respondersToReset.length} responders to station (${onScene} on-scene, ${enRoute} en-route, ${dispatched} dispatched)`);\n              \n              // Reset all responders asynchronously\n              const resetPromises = respondersToReset.map(responder => {\n                // Get the firestation to reset position\n                const station = firestations.find(fs => fs.id === responder.firestation_id);\n                if (station) {\n                  // Remove marker if it exists\n                  if (responder.marker) {\n                    try {\n                      responder.marker.remove();\n                    } catch (e) {\n                      console.error('Error removing marker:', e);\n                    }\n                  }\n                  \n                  // Try units table first, fallback to responders\n                  const resetUnit = async () => {\n                    try {\n                      return await supabase.from('units').update({\n                        status: 'available',\n                        incident_id: null,\n                        current_lat: station.lat,\n                        current_lon: station.lon,\n                        dispatched_at: null,\n                        arrived_at: null\n                      }).eq('id', responder.id);\n                    } catch {\n                      return await supabase.from('responders').update({\n                        status: 'available',\n                        incident_id: null,\n                        current_lat: station.lat,\n                        current_lon: station.lon,\n                        dispatched_at: null,\n                        arrived_at: null\n                      }).eq('id', responder.id);\n                    }\n                  };\n                  return resetUnit()\n                    .then(({ error }) => {\n                      if (!error) {\n                        console.log(`[Fire Containment] âœ… Team ${responder.team_number} returned to available at ${station.name}`);\n                      } else {\n                        console.error(`[Fire Containment] Error resetting team ${responder.team_number}:`, error);\n                      }\n                    });\n                }\n                return Promise.resolve();\n              });\n              \n              // Wait for all responders to be reset, then update UI state\n              Promise.all(resetPromises).then(() => {\n                // Update local state to remove ALL responders for this incident\n                setResponders(prev => {\n                  const updated = prev.filter(r => \n                    String(r.incident_id) !== String(incident.id)\n                  );\n                  latestRespondersRef.current = updated;\n                  return updated;\n                });\n                \n                // Trigger responder stats refresh to update UI counts\n                if (onResponderUpdate) {\n                  setTimeout(() => {\n                    console.log('[Fire Containment] Triggering responder stats refresh');\n                    // Force a refresh by re-fetching stats\n                    fetch('/api/dispatch-unit')\n                      .then(res => res.json())\n                      .then(data => {\n                        if (unitUpdateCallback && data.totals) {\n                          unitUpdateCallback(\n                            {\n                              available: data.totals.available || 0,\n                              dispatched: data.totals.dispatched || 0,\n                              active: data.totals.on_scene || data.totals.active || 0\n                            },\n                            data.activeUnits || data.activeResponders || []\n                          );\n                        }\n                      })\n                      .catch(err => console.error('Error refreshing unit stats:', err));\n                  }, 500); // Small delay to ensure DB updates complete\n                }\n              });\n              \n              // Clear containment state and reset counters\n              state.containmentStartTime = undefined;\n              state.respondersOnScene = 0;\n              state.maxRadiusBeforeContainment = undefined;\n              \n              console.log('[Fire Containment] Fire state fully reset, ready for next incident');\n            }\n          } else {\n            // Only grow if containment hasn't started\n            // Once containment starts, this branch never executes again for this fire\n            if (!state.containmentStartTime) {\n              // Calculate growth over time with very slow, steady expansion\n              // Fire spreads slowly but visibly over 240 seconds (4 minutes)\n              const growthProgress = Math.min(elapsedSeconds / 240, 1); // 240 seconds to reach full size\n              const easedGrowth = 1 - Math.pow(1 - growthProgress, 1.8); // Even slower ease out\n              \n              // Add extremely subtle pulsing variation (barely noticeable)\n              const pulse = Math.sin(elapsedSeconds * state.waveSpeed + state.seed) * 0.01;\n              \n              // Calculate final radius with slow natural growth curve\n              // Starts at 2%, grows to 100% over 4 minutes (starts smaller)\n              radiusMultiplier = 0.02 + (easedGrowth * 0.98) + pulse;\n            } else {\n              // Containment started but responders left - keep fire at locked size\n              radiusMultiplier = 1.0;\n            }\n          }\n\n          const radiusMeters = state.baseRadius * radiusMultiplier;\n\n          // Very subtle intensity variation for stable appearance\n          const intensity = clamp(\n            0.6 + 0.15 * Math.abs(Math.sin(elapsedSeconds * 0.8 + state.seed)),\n            0.55,\n            0.85\n          );\n\n          return createFireFeature(incident, radiusMeters, {\n            time: elapsedSeconds,\n            roughness: state.roughness,\n            seed: state.seed,\n            intensity,\n            points: 24, // Fewer edges for simpler polygon\n            growthVectors: state.growthVectors,\n            elapsedTime: elapsedSeconds\n          });\n        });\n\n        const source = map.getSource(fireSourceId) as mapboxgl.GeoJSONSource | undefined;\n        if (source) {\n          source.setData({\n            type: 'FeatureCollection',\n            features\n          });\n        }\n\n        fireAnimationRef.current = requestAnimationFrame(animateFire);\n      };\n\n      fireAnimationRef.current = requestAnimationFrame(animateFire);\n\n      // Add static wildfire markers\n      incidents.forEach((incident) => {\n        const [lng, lat] = incident.coordinates;\n        if (typeof lng !== 'number' || typeof lat !== 'number') return;\n\n        const intensity = incident.intensity || 'low';\n        const isActive = incident.status === 'active';\n\n        // Create marker element\n        const markerEl = document.createElement('div');\n        markerEl.className = 'relative';\n        markerEl.style.cursor = 'pointer';\n        markerEl.style.zIndex = '100'; // Fire incidents always on top\n\n        if (isActive) {\n          const pulseEl = document.createElement('div');\n          pulseEl.className = 'absolute rounded-full border-2 opacity-30 pulse-animation';\n          pulseEl.style.width = `${getPulseSize(intensity)}px`;\n          pulseEl.style.height = `${getPulseSize(intensity)}px`;\n          pulseEl.style.borderColor = getMarkerColor(intensity);\n          pulseEl.style.transform = 'translate(-50%, -50%)';\n          pulseEl.style.top = '50%';\n          pulseEl.style.left = '50%';\n          pulseEl.style.position = 'absolute';\n          pulseEl.style.zIndex = '1';\n          markerEl.appendChild(pulseEl);\n        }\n\n        const mainMarker = document.createElement('div');\n        mainMarker.className = 'rounded-full border-2 border-white shadow-lg relative';\n        mainMarker.style.width = `${getMarkerSize(intensity)}px`;\n        mainMarker.style.height = `${getMarkerSize(intensity)}px`;\n        mainMarker.style.backgroundColor = getMarkerColor(intensity);\n        mainMarker.style.transform = 'translate(-50%, -50%)';\n        mainMarker.style.position = 'absolute';\n        mainMarker.style.top = '50%';\n        mainMarker.style.left = '50%';\n        mainMarker.style.zIndex = '100'; // Higher z-index for fire markers\n        mainMarker.style.boxShadow = `0 0 20px ${getMarkerColor(intensity)}40`;\n        markerEl.appendChild(mainMarker);\n\n        if (intensity === 'critical') {\n          const particleEl = document.createElement('div');\n          particleEl.className = 'particle-trail';\n          markerEl.appendChild(particleEl);\n        }\n\n        // Add fire name label (hidden by default, shown when selected)\n        const labelEl = document.createElement('div');\n        labelEl.className = 'absolute whitespace-nowrap fire-label';\n        labelEl.style.left = '50%';\n        labelEl.style.top = '100%';\n        labelEl.style.transform = 'translateX(-50%)';\n        labelEl.style.marginTop = '8px';\n        labelEl.style.backgroundColor = 'rgba(0, 0, 0, 0.75)';\n        labelEl.style.color = 'white';\n        labelEl.style.padding = '4px 8px';\n        labelEl.style.borderRadius = '6px';\n        labelEl.style.fontSize = '11px';\n        labelEl.style.fontWeight = '600';\n        labelEl.style.border = `1px solid ${getMarkerColor(intensity)}`;\n        labelEl.style.boxShadow = '0 2px 4px rgba(0,0,0,0.3)';\n        labelEl.style.pointerEvents = 'none';\n        labelEl.style.zIndex = '101';\n        labelEl.style.display = 'none'; // Hidden by default\n        labelEl.textContent = incident.name;\n        labelEl.setAttribute('data-fire-id', incident.id.toString());\n        markerEl.appendChild(labelEl);\n\n        const marker = new mapboxgl.Marker({ element: markerEl })\n          .setLngLat([lng, lat])\n          .addTo(map);\n\n        markerEl.addEventListener('click', () => {\n          // Set selected fire ID\n          const numericId = typeof incident.id === 'number' ? incident.id : parseInt(String(incident.id), 10);\n          setSelectedFireId(numericId);\n          \n          // Notify parent component that this incident was selected\n          if (onIncidentSelect) {\n            // Find the original incident to get all required fields\n            const originalIncident = incidents.find(i => i.id === incident.id);\n            if (originalIncident) {\n              onIncidentSelect({\n                id: originalIncident.id.toString(),\n                name: originalIncident.name,\n                risk: originalIncident.intensity as 'low' | 'medium' | 'high' | 'critical',\n                lat: lat,\n                lon: lng,\n                containment: originalIncident.containment || 0,\n                last_update: originalIncident.last_update || new Date().toISOString(),\n                description: originalIncident.description || null,\n              });\n            }\n          }\n          \n          // Find nearest fire station and display route (only for active fires)\n          if (incident.status === 'active') {\n            const nearestStation = findNearestFirestation(lat, lng, firestations);\n            if (nearestStation) {\n              displayRouteToFire(lat, lng, nearestStation.lat, nearestStation.lon);\n            }\n          }\n\n          map.flyTo({\n            center: [lng, lat],\n            zoom: 17,\n            pitch: 60,\n            bearing: map.getBearing(),\n            duration: 3500,\n            padding: { top: 260, bottom: 40, left: 40, right: 40 },\n            essential: true\n          });\n\n          if (popupRef.current) {\n            popupRef.current.remove();\n          }\n\n          const popupContent = createPopupContent(incident);\n\n          popupRef.current = new mapboxgl.Popup({ closeButton: true, closeOnClick: true, maxWidth: '380px', offset: 20, anchor: 'bottom' })\n            .setLngLat([lng, lat])\n            .setHTML(popupContent)\n            .addTo(map);\n\n          // After popup is added, wire up fullscreen toggle behavior\n          try {\n            const popupNode = popupRef.current?.getElement();\n            if (popupNode) {\n              const content = popupNode.querySelector('.mapboxgl-popup-content') as HTMLElement | null;\n              const videoEl = content?.querySelector('video[data-video-element=\"true\"]') as HTMLVideoElement | null;\n              const toggleBtn = content?.querySelector('button[data-fullscreen-toggle=\"true\"]') as HTMLButtonElement | null;\n              if (videoEl && toggleBtn) {\n                toggleBtn.onclick = async () => {\n                  try {\n                    const anyVideo: any = videoEl as any;\n                    if (!document.fullscreenElement) {\n                      if (videoEl.requestFullscreen) await videoEl.requestFullscreen();\n                      else if (anyVideo.webkitRequestFullscreen) await anyVideo.webkitRequestFullscreen();\n                      else if (anyVideo.msRequestFullscreen) await anyVideo.msRequestFullscreen();\n                    } else {\n                      const anyDoc: any = document as any;\n                      if (document.exitFullscreen) await document.exitFullscreen();\n                      else if (anyDoc.webkitExitFullscreen) await anyDoc.webkitExitFullscreen();\n                      else if (anyDoc.msExitFullscreen) await anyDoc.msExitFullscreen();\n                    }\n                  } catch (e) {\n                    console.warn('Popup fullscreen failed, opening fallback modal');\n                    // Fallback: open the React modal by dispatching a custom event the page can listen to\n                    window.dispatchEvent(new CustomEvent('openVideoModal', { detail: { fireName: incident.name } }));\n                  }\n                };\n              }\n            }\n          } catch (e) {\n            // No-op if wiring fails\n          }\n        });\n\n        markersRef.current.push(marker);\n      });\n\n      // Add firestation markers\n      firestations.forEach((firestation) => {\n        const { lat, lon, name } = firestation;\n        if (typeof lat !== 'number' || typeof lon !== 'number') return;\n\n        // Create firestation marker element\n        const markerEl = createFirestationMarker();\n\n        // Create marker\n        const marker = new mapboxgl.Marker({ \n          element: markerEl,\n          anchor: 'center'\n        })\n          .setLngLat([lon, lat])\n          .addTo(map);\n\n        // Add click event for popup\n        markerEl.addEventListener('click', (e) => {\n          e.stopPropagation();\n          if (popupRef.current) {\n            popupRef.current.remove();\n          }\n\n          const popupContent = createFirestationPopupContent(firestation);\n\n          popupRef.current = new mapboxgl.Popup({ \n            closeButton: true, \n            closeOnClick: true, \n            maxWidth: '300px', \n            offset: 25, \n            anchor: 'bottom' \n          })\n            .setLngLat([lon, lat])\n            .setHTML(popupContent)\n            .addTo(map);\n        });\n\n        markersRef.current.push(marker);\n      });\n    });\n\n    // Cursor interactions\n    map.on('mousemove', () => {\n      map.getCanvas().style.cursor = 'grab';\n    });\n\n    map.on('mousedown', () => {\n      map.getCanvas().style.cursor = 'grabbing';\n    });\n\n    map.on('mouseup', () => {\n      map.getCanvas().style.cursor = 'grab';\n    });\n\n    // Cleanup\n    return () => {\n      markersRef.current.forEach(marker => marker.remove());\n      markersRef.current = [];\n      if (popupRef.current) {\n        popupRef.current.remove();\n      }\n      if (fireAnimationRef.current !== null) {\n        cancelAnimationFrame(fireAnimationRef.current);\n        fireAnimationRef.current = null;\n      }\n      fireStartTimeRef.current = null;\n      if (mapRef.current && mapRef.current.getLayer('fire-glow-outline')) {\n        mapRef.current.removeLayer('fire-glow-outline');\n      }\n      if (mapRef.current && mapRef.current.getLayer(fireLayerId)) {\n        mapRef.current.removeLayer(fireLayerId);\n      }\n      if (mapRef.current && mapRef.current.getSource(fireSourceId)) {\n        mapRef.current.removeSource(fireSourceId);\n      }\n      // Clean up route layers\n      if (mapRef.current && mapRef.current.getLayer(routeArrowLayerId)) {\n        mapRef.current.removeLayer(routeArrowLayerId);\n      }\n      if (mapRef.current && mapRef.current.getLayer(routeLayerId)) {\n        mapRef.current.removeLayer(routeLayerId);\n      }\n      if (mapRef.current && mapRef.current.getSource(routeSourceId)) {\n        mapRef.current.removeSource(routeSourceId);\n      }\n      map.remove();\n    };\n  }, [loading, incidents, firestations, displayRouteToFire]);\n\n  // Wind values are now LOCKED when fire is created - no updates when wind changes\n  // This prevents fire from constantly changing as user pans/zooms the map\n  // Each fire uses its initial wind conditions throughout its lifecycle\n\n  // Update fire label visibility when selected fire changes\n  useEffect(() => {\n    // Hide all labels first\n    document.querySelectorAll('.fire-label').forEach((label) => {\n      (label as HTMLElement).style.display = 'none';\n    });\n    \n    // Show label for selected fire\n    if (selectedFireId !== null) {\n      const selectedLabel = document.querySelector(`.fire-label[data-fire-id=\"${selectedFireId}\"]`);\n      if (selectedLabel) {\n        (selectedLabel as HTMLElement).style.display = 'block';\n      }\n    }\n  }, [selectedFireId]);\n\n  // Reset view function\n  const resetView = useCallback(() => {\n    if (mapRef.current) {\n      // Clear selected fire\n      setSelectedFireId(null);\n      \n      // Clear any existing route\n      if (mapRef.current.getLayer(routeArrowLayerId)) {\n        mapRef.current.removeLayer(routeArrowLayerId);\n      }\n      if (mapRef.current.getLayer(routeLayerId)) {\n        mapRef.current.removeLayer(routeLayerId);\n      }\n      if (mapRef.current.getSource(routeSourceId)) {\n        mapRef.current.removeSource(routeSourceId);\n      }\n      \n      mapRef.current.flyTo({\n        center: [-122.0, 38.5],\n        zoom: 7.5,\n        pitch: 45,\n        bearing: 0,\n        duration: 1500\n      });\n    }\n  }, []);\n\n  // Show loading state\n  if (loading) {\n    return (\n      <div className={`w-full h-full relative ${className} flex items-center justify-center`}>\n        <div className=\"text-white/70 text-sm\">Loading incident data...</div>\n      </div>\n    );\n  }\n\n  // Show error state\n  if (error) {\n    return (\n      <div className={`w-full h-full relative ${className} flex items-center justify-center`}>\n        <div className=\"text-red-400 text-sm\">Error: {error}</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`w-full h-full relative ${className}`}>\n      {/* Vignette overlay for depth */}\n      <div className=\"vignette-overlay z-10 pointer-events-none\" />\n      \n      {/* Map container */}\n      <div\n        ref={mapContainerRef}\n        className=\"absolute inset-0 z-0\"\n        style={{ width: '100%', height: '100%', pointerEvents: 'auto' }}\n        />\n\n        {/* Custom Reset View Button - Positioned at bottom left to cover Mapbox logo */}\n      <div className=\"absolute bottom-0 left-0 z-30\">\n          <button\n            onClick={resetView}\n          className=\"bg-black/20 backdrop-blur-md border border-white/20 rounded-lg px-2 py-1 text-white text-xs font-medium hover:bg-black/30 hover:border-white/30 transition-all duration-200 flex items-center gap-1 m-1\"\n            title=\"Reset to California View\"\n          >\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <path d=\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\"/>\n              <path d=\"M21 3v5h-5\"/>\n              <path d=\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\"/>\n              <path d=\"M3 21v-5h5\"/>\n            </svg>\n            Reset View\n          </button>\n        </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2836, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/components/leaflet-map.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef, useState, useCallback } from 'react';\nimport { supabase } from '@/lib/supabase-client';\n\ndeclare global {\n  interface Window {\n    L: any;\n  }\n}\n\n// OSM tiles for lightweight 2D view\nconst tileUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';\nconst tileAttribution =\n  '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors';\n\ntype Incident = {\n  id: string;\n  name: string | null;\n  priority?: string | null;\n  risk?: string | null;\n  lat: number | null;\n  lon: number | null;\n  containment?: number | null;\n};\n\ntype Unit = {\n  id: string;\n  station_id: number;\n  unit_number?: string;\n  status: 'available' | 'dispatched' | 'en_route' | 'on_scene' | 'returning';\n  current_lat: number;\n  current_lon: number;\n  incident_id?: string | null;\n};\n\ntype Dispatch = {\n  id: string;\n  incident_id: string;\n  unit_id: string;\n  status: string;\n};\n\ntype Checkpoint = {\n  id: string;\n  label: string;\n  lat: number;\n  lon: number;\n  priority?: string | null;\n};\n\ninterface LeafletMapProps {\n  onReady?: (fly: (lat: number, lon: number, zoom?: number) => void) => void;\n}\n\nexport default function LeafletMap({ onReady }: LeafletMapProps) {\n  const mapRef = useRef<HTMLDivElement | null>(null);\n  const mapInstance = useRef<any>(null);\n  const leafletRef = useRef<any>(null);\n  const markersRef = useRef<Record<string, any>>({});\n  const unitMarkersRef = useRef<Record<string, any>>({});\n  const checkpointMarkersRef = useRef<Record<string, any>>({});\n  const lineLayersRef = useRef<Record<string, any>>({});\n  const userMarker = useRef<any>(null);\n\n  const [dataVersion, setDataVersion] = useState(0);\n\n  // Data fetch / polling\n  useEffect(() => {\n    let cancel = false;\n    const fetchData = async () => {\n      const [incidentsRes, unitsRes, dispatchesRes, checkpointsRes] = await Promise.all([\n        supabase.from('incidents').select('*'),\n        supabase.from('units').select('*'),\n        supabase.from('dispatches').select('*'),\n        supabase.from('checkpoints').select('*'),\n      ]);\n      if (cancel) return;\n      syncIncidents((incidentsRes.data ?? []) as Incident[]);\n      syncUnits((unitsRes.data ?? []) as Unit[]);\n      syncDispatches((dispatchesRes.data ?? []) as Dispatch[]);\n      syncCheckpoints((checkpointsRes.data ?? []) as Checkpoint[]);\n    };\n    fetchData();\n    const id = setInterval(fetchData, 5000);\n    return () => {\n      cancel = true;\n      clearInterval(id);\n    };\n  }, []);\n\n  // Lazy load Leaflet and init map\n  useEffect(() => {\n    let mounted = true;\n\n    const loadLeaflet = async () => {\n      if (window.L) return window.L;\n\n      // CSS\n      if (!document.getElementById('leaflet-css')) {\n        const link = document.createElement('link');\n        link.id = 'leaflet-css';\n        link.rel = 'stylesheet';\n        link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\n        document.head.appendChild(link);\n      }\n\n      // JS\n      if (!document.getElementById('leaflet-js')) {\n        await new Promise<void>((resolve, reject) => {\n          const script = document.createElement('script');\n          script.id = 'leaflet-js';\n          script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\n          script.async = true;\n          script.onload = () => resolve();\n          script.onerror = (err) => reject(err);\n          document.body.appendChild(script);\n        });\n      }\n      return window.L;\n    };\n\n    const init = async () => {\n      if (mapInstance.current) return;\n\n      const L = await loadLeaflet();\n      if (!mounted || !L) return;\n\n      leafletRef.current = L;\n      const map = L.map(mapRef.current as any, {\n        center: [40.4427, -79.9425],\n        zoom: 14,\n        maxZoom: 20,\n        worldCopyJump: true,\n      });\n      L.tileLayer(tileUrl, { attribution: tileAttribution, maxZoom: 20 }).addTo(map);\n\n      // My location\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(\n          (pos) => {\n            const coords: [number, number] = [pos.coords.latitude, pos.coords.longitude];\n            map.setView(coords, 14);\n            const mk = L.circleMarker(coords, {\n              radius: 10,\n              color: '#7cc5ff',\n              weight: 2,\n              fillColor: '#7cc5ff',\n              fillOpacity: 0.35,\n              className: 'my-location-dot',\n            })\n              .addTo(map)\n              .bindPopup('You are here');\n            userMarker.current = mk;\n          },\n          () => {},\n          { enableHighAccuracy: true, timeout: 3000, maximumAge: 60000 }\n        );\n      }\n\n      // Add checkpoint on click\n      map.on('click', async (e: any) => {\n        const label = prompt('Checkpoint label?', 'Checkpoint');\n        if (!label) return;\n        const newPoint = {\n          id: crypto.randomUUID(),\n          lat: +e.latlng.lat.toFixed(5),\n          lon: +e.latlng.lng.toFixed(5),\n          label,\n          priority: 'medium',\n        };\n        await supabase.from('checkpoints').insert(newPoint);\n        setDataVersion((v) => v + 1);\n      });\n\n      // expose flyTo handler\n      const fly = (lat: number, lon: number, zoom = 14) => {\n        map.flyTo([lat, lon], zoom, { duration: 0.75 });\n      };\n      onReady?.(fly);\n\n      mapInstance.current = map;\n    };\n    init();\n    return () => {\n      mounted = false;\n    };\n  }, [onReady]);\n\n  // Helpers to render layers\n  const syncIncidents = useCallback(\n    (incidents: Incident[]) => {\n      const L = leafletRef.current;\n      const map = mapInstance.current;\n      if (!L || !map) return;\n      // remove missing\n      Object.keys(markersRef.current).forEach((id) => {\n        if (!incidents.find((i) => i.id === id)) {\n          markersRef.current[id].remove();\n          delete markersRef.current[id];\n        }\n      });\n      incidents.forEach((inc) => {\n        if (!inc.lat || !inc.lon) return;\n        const color = '#ff3b30';\n        const radius = 10;\n        let marker = markersRef.current[inc.id];\n        if (!marker) {\n          marker = L.circleMarker([inc.lat, inc.lon], {\n            radius,\n            color,\n            weight: 2,\n            fillColor: color,\n            fillOpacity: 0.25,\n          }).addTo(map);\n          marker.bindTooltip(inc.name || 'Crime scene', { permanent: true, direction: 'top', className: 'leaflet-label' });\n          markersRef.current[inc.id] = marker;\n        } else {\n          marker.setLatLng([inc.lat, inc.lon]);\n        }\n      });\n    },\n    []\n  );\n\n  const syncUnits = useCallback((units: Unit[]) => {\n    const L = leafletRef.current;\n    const map = mapInstance.current;\n    if (!L || !map) return;\n    Object.keys(unitMarkersRef.current).forEach((id) => {\n      if (!units.find((u) => u.id === id)) {\n        unitMarkersRef.current[id].remove();\n        delete unitMarkersRef.current[id];\n      }\n    });\n    units.forEach((u) => {\n      const color =\n        u.status === 'available' ? '#22c55e' : u.status === 'on_scene' ? '#2563eb' : '#facc15'; // yellow for dispatched/en_route\n      const radius = 8;\n      const label = u.unit_number || u.id.slice(0, 6);\n      let marker = unitMarkersRef.current[u.id];\n      if (!marker) {\n        marker = L.circleMarker([u.current_lat, u.current_lon], {\n          radius,\n          color,\n          weight: 2,\n          fillColor: color,\n          fillOpacity: 0.4,\n        }).addTo(map);\n        marker.bindTooltip(label, { permanent: false, direction: 'right', className: 'leaflet-label unit' });\n        unitMarkersRef.current[u.id] = marker;\n      } else {\n        marker.setLatLng([u.current_lat, u.current_lon]);\n        marker.setStyle({ color, fillColor: color });\n      }\n    });\n  }, []);\n\n  const syncCheckpoints = useCallback((points: Checkpoint[]) => {\n    const L = leafletRef.current;\n    const map = mapInstance.current;\n    if (!L || !map) return;\n    Object.keys(checkpointMarkersRef.current).forEach((id) => {\n      if (!points.find((p) => p.id === id)) {\n        checkpointMarkersRef.current[id].remove();\n        delete checkpointMarkersRef.current[id];\n      }\n    });\n    points.forEach((p) => {\n      const color = '#22d3ee';\n      let marker = checkpointMarkersRef.current[p.id];\n      if (!marker) {\n        const icon = L.divIcon({\n          className: 'checkpoint-icon',\n          html: `<div class=\"checkpoint-dot\" style=\"background:${color}\"></div><span class=\"checkpoint-label\">${p.label}</span>`,\n          iconAnchor: [8, 8],\n        });\n        marker = L.marker([p.lat, p.lon], { icon }).addTo(map);\n        marker.on('click', async (ev: any) => {\n          ev.originalEvent.stopPropagation();\n          await supabase.from('checkpoints').delete().eq('id', p.id);\n          setDataVersion((v) => v + 1);\n        });\n        checkpointMarkersRef.current[p.id] = marker;\n      } else {\n        marker.setLatLng([p.lat, p.lon]);\n      }\n    });\n  }, []);\n\n  const syncDispatches = useCallback((dispatches: Dispatch[]) => {\n    const L = leafletRef.current;\n    const map = mapInstance.current;\n    if (!L || !map) return;\n    // build lookup\n    const units = supabase.__data.units as Unit[];\n    const incidents = supabase.__data.incidents as Incident[];\n    Object.values(lineLayersRef.current).forEach((layer) => layer.remove());\n    lineLayersRef.current = {};\n    dispatches.forEach((d) => {\n      const unit = units.find((u) => u.id === d.unit_id);\n      const inc = incidents.find((i) => i.id === d.incident_id);\n      if (!unit || !inc || !inc.lat || !inc.lon) return;\n      const line = L.polyline(\n        [\n          [unit.current_lat, unit.current_lon],\n          [inc.lat, inc.lon],\n        ],\n        { color: '#f59e0b', weight: 3, dashArray: '6,6' }\n      ).addTo(map);\n      lineLayersRef.current[d.id] = line;\n    });\n  }, []);\n\n  return (\n    <div className=\"w-full h-full relative\">\n      <div ref={mapRef} className=\"w-full h-full rounded-xl border border-white/10 shadow-inner overflow-hidden\" />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3239, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/hooks/use-vapi.ts"],"sourcesContent":["'use client';\n\nimport { useEffect, useState, useCallback } from 'react';\nimport Vapi from '@vapi-ai/web';\n\nexport interface VapiMessage {\n  type: string;\n  transcript?: string;\n  role?: 'user' | 'assistant';\n  content?: string;\n  timestamp?: string;\n}\n\nexport function useVapi() {\n  const [vapi, setVapi] = useState<Vapi | null>(null);\n  const [isSessionActive, setIsSessionActive] = useState(false);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [messages, setMessages] = useState<VapiMessage[]>([]);\n  const [volumeLevel, setVolumeLevel] = useState(0);\n\n  useEffect(() => {\n    const vapiInstance = new Vapi(process.env.NEXT_PUBLIC_VAPI_PUBLIC_KEY || '');\n    setVapi(vapiInstance);\n\n    // Event listeners\n    vapiInstance.on('call-start', () => {\n      console.log('Call started');\n      setIsSessionActive(true);\n    });\n\n    vapiInstance.on('call-end', () => {\n      console.log('Call ended');\n      setIsSessionActive(false);\n      setIsSpeaking(false);\n    });\n\n    vapiInstance.on('speech-start', () => {\n      console.log('Assistant started speaking');\n      setIsSpeaking(true);\n    });\n\n    vapiInstance.on('speech-end', () => {\n      console.log('Assistant finished speaking');\n      setIsSpeaking(false);\n    });\n\n    vapiInstance.on('message', (message: any) => {\n      console.log('Message received:', message);\n      \n      // Only process final transcripts, not partial ones\n      if (message.type === 'transcript' && message.transcript && message.transcriptType === 'final') {\n        setMessages((prev) => {\n          const timestamp = new Date().toLocaleTimeString('en-US', { \n            hour: '2-digit', \n            minute: '2-digit' \n          });\n          \n          // Check if the last message is from the same role and recent (within 5 seconds)\n          const lastMessage = prev[prev.length - 1];\n          const isRecentMessage = lastMessage && \n            lastMessage.role === message.role && \n            lastMessage.timestamp === timestamp;\n          \n          if (isRecentMessage) {\n            // Append to the existing message\n            const updated = [...prev];\n            updated[updated.length - 1] = {\n              ...lastMessage,\n              content: lastMessage.content + ' ' + message.transcript,\n            };\n            return updated;\n          } else {\n            // Add as a new message\n            return [\n              ...prev,\n              {\n                type: 'transcript',\n                role: message.role,\n                content: message.transcript,\n                timestamp,\n              },\n            ];\n          }\n        });\n      }\n    });\n\n    vapiInstance.on('volume-level', (level: number) => {\n      setVolumeLevel(level);\n    });\n\n    vapiInstance.on('error', (error: any) => {\n      console.warn('VAPI error:', error);\n      // Don't treat VAPI errors as critical - they're often just connection issues\n    });\n\n    return () => {\n      vapiInstance.stop();\n    };\n  }, []);\n\n  const start = useCallback(async () => {\n    if (!vapi) return;\n\n    try {\n      // Use the assistant ID from VAPI dashboard\n      await vapi.start('b497d653-42b2-4657-b831-9dfc975254a5');\n    } catch (error) {\n      console.error('Failed to start VAPI:', error);\n    }\n  }, [vapi]);\n\n  const stop = useCallback(() => {\n    if (!vapi) return;\n    vapi.stop();\n  }, [vapi]);\n\n  const send = useCallback((message: string) => {\n    if (!vapi) return;\n    vapi.send({\n      type: 'add-message',\n      message: {\n        role: 'system',\n        content: message,\n      },\n    });\n  }, [vapi]);\n\n  const receiveAgentMessage = useCallback((agentData: { action: string; message: string; data?: any }) => {\n    if (!vapi) return;\n    \n    // Send to VAPI as system message so it speaks it out\n    vapi.send({\n      type: 'add-message',\n      message: {\n        role: 'system',\n        content: `ALERT: ${agentData.message}. Please acknowledge.`\n      }\n    });\n    \n    // Also add to local messages for UI display\n    setMessages(prev => [...prev, {\n      type: 'agent-alert',\n      role: 'assistant',\n      content: agentData.message,\n      timestamp: new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })\n    }]);\n  }, [vapi]);\n\n  return {\n    isSessionActive,\n    isSpeaking,\n    messages,\n    volumeLevel,\n    start,\n    stop,\n    send,\n    receiveAgentMessage,\n  };\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3430, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/hooks/use-weather.ts"],"sourcesContent":["'use client';\n\nimport { useEffect, useState, useCallback } from 'react';\n\nexport interface WeatherData {\n  wind: {\n    speed: number;\n    deg: number;\n    direction: string;\n  };\n  temp: number;\n  humidity: number;\n  visibility: number | null;\n  airQuality: {\n    aqi: number | null;\n    pm2_5: number | null;\n    pm10: number | null;\n  } | null;\n  description: string;\n  location: string;\n}\n\nexport function useWeather(lat: number | null, lon: number | null) {\n  const [weather, setWeather] = useState<WeatherData | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchWeather = useCallback(async (latitude: number, longitude: number) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(\n        `/api/weather?lat=${latitude}&lon=${longitude}`\n      );\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ error: 'Unknown error' }));\n        const errorMessage = errorData.error || `HTTP ${response.status}: ${response.statusText}`;\n        console.error('Weather API error:', errorMessage);\n        throw new Error(errorMessage);\n      }\n\n      const data = await response.json();\n      setWeather(data);\n    } catch (err) {\n      console.error('Error fetching weather:', err);\n      const errorMessage = err instanceof Error ? err.message : 'Unknown error';\n      setError(errorMessage);\n      setWeather(null);\n      \n      // Set fallback weather data to prevent UI breakage\n      setWeather({\n        wind: { speed: 0, deg: 0, direction: 'N/A' },\n        temp: 0,\n        humidity: 0,\n        visibility: null,\n        airQuality: null,\n        description: 'Weather data unavailable',\n        location: 'Unknown',\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (lat !== null && lon !== null) {\n      // Debounce the weather fetch to avoid too many API calls\n      const timeoutId = setTimeout(() => {\n        fetchWeather(lat, lon);\n      }, 1000); // Wait 1 second after map stops moving\n\n      return () => clearTimeout(timeoutId);\n    }\n  }, [lat, lon, fetchWeather]);\n\n  return { weather, loading, error, refetch: fetchWeather };\n}\n\n"],"names":[],"mappings":";;;;AAEA;;AAFA;;AAsBO,SAAS,WAAW,GAAkB,EAAE,GAAkB;;IAC/D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,oMAAQ,EAAqB;IAC3D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,oMAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,oMAAQ,EAAgB;IAElD,MAAM,eAAe,IAAA,uMAAW;gDAAC,OAAO,UAAkB;YACxD,WAAW;YACX,SAAS;YAET,IAAI;gBACF,MAAM,WAAW,MAAM,MACrB,CAAC,iBAAiB,EAAE,SAAS,KAAK,EAAE,WAAW;gBAGjD,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,MAAM,YAAY,MAAM,SAAS,IAAI,GAAG,KAAK;gEAAC,IAAM,CAAC;gCAAE,OAAO;4BAAgB,CAAC;;oBAC/E,MAAM,eAAe,UAAU,KAAK,IAAI,CAAC,KAAK,EAAE,SAAS,MAAM,CAAC,EAAE,EAAE,SAAS,UAAU,EAAE;oBACzF,QAAQ,KAAK,CAAC,sBAAsB;oBACpC,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,OAAO,MAAM,SAAS,IAAI;gBAChC,WAAW;YACb,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,MAAM,eAAe,eAAe,QAAQ,IAAI,OAAO,GAAG;gBAC1D,SAAS;gBACT,WAAW;gBAEX,mDAAmD;gBACnD,WAAW;oBACT,MAAM;wBAAE,OAAO;wBAAG,KAAK;wBAAG,WAAW;oBAAM;oBAC3C,MAAM;oBACN,UAAU;oBACV,YAAY;oBACZ,YAAY;oBACZ,aAAa;oBACb,UAAU;gBACZ;YACF,SAAU;gBACR,WAAW;YACb;QACF;+CAAG,EAAE;IAEL,IAAA,qMAAS;gCAAC;YACR,IAAI,QAAQ,QAAQ,QAAQ,MAAM;gBAChC,yDAAyD;gBACzD,MAAM,YAAY;sDAAW;wBAC3B,aAAa,KAAK;oBACpB;qDAAG,OAAO,uCAAuC;gBAEjD;4CAAO,IAAM,aAAa;;YAC5B;QACF;+BAAG;QAAC;QAAK;QAAK;KAAa;IAE3B,OAAO;QAAE;QAAS;QAAS;QAAO,SAAS;IAAa;AAC1D;GAxDgB","debugId":null}},
    {"offset": {"line": 3519, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/components/IncidentsList.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { supabase } from '@/lib/supabase-client'\nimport { Badge } from '@/components/ui/badge'\nimport { MapPin } from 'lucide-react'\n\ntype Incident = {\n  id: string\n  name: string | null\n  priority: 'low' | 'medium' | 'high' | 'critical' | null\n  risk?: 'low' | 'medium' | 'high' | 'critical' | null // Backward compatibility\n  lat: number | null\n  lon: number | null\n  containment: number | null\n  last_update: string\n  incident_type?: string | null\n}\n\nfunction PriorityBadge({ priority, risk }: { priority?: Incident['priority'], risk?: Incident['risk'] }) {\n  // Support both 'priority' (police) and 'risk' (fire) for backward compatibility\n  const level = priority || risk || null;\n  const color =\n    level === 'critical' ? '#FF6B00' :\n    level === 'high' ? '#FF4444' :\n    level === 'medium' ? '#FFA800' :\n    '#00C2FF'\n  return (\n    <Badge className=\"border-0 text-xs font-medium px-2 py-1 whitespace-nowrap flex-shrink-0\"\n      style={{ backgroundColor: `${color}33`, color }}>\n      {level ? level[0].toUpperCase() + level.slice(1) : 'N/A'}\n    </Badge>\n  )\n}\n\ninterface IncidentsListProps {\n  onIncidentClick?: (incident: Incident) => void;\n  onIncidentCountChange?: (count: number) => void;\n  onIncidentsUpdate?: (incidents: Incident[]) => void;\n}\n\nexport default function IncidentsList({ onIncidentClick, onIncidentCountChange, onIncidentsUpdate }: IncidentsListProps) {\n  const [rows, setRows] = useState<Incident[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n\n  useEffect(() => {\n    let cancelled = false\n\n    ;(async () => {\n      const { data, error } = await supabase\n        .from('incidents')\n        .select('*')\n        .order('last_update', { ascending: false })\n        .limit(25)\n\n      if (cancelled) return\n      if (error) setError(error.message)\n      else {\n        const incidents = (data ?? []) as Incident[]\n        setRows(incidents)\n        onIncidentCountChange?.(incidents.length)\n        onIncidentsUpdate?.(incidents)\n      }\n      setLoading(false)\n    })()\n\n    // realtime updates\n    const ch = supabase\n      .channel('incidents-rt')\n      .on('postgres_changes',\n        { event: '*', schema: 'public', table: 'incidents' },\n        payload => {\n          const n = payload.new as Incident\n          setRows(prev => {\n            const without = prev.filter(i => i.id !== n.id)\n            const newRows = [n, ...without].slice(0, 25)\n            onIncidentCountChange?.(newRows.length)\n            onIncidentsUpdate?.(newRows)\n            return newRows\n          })\n        })\n      .subscribe()\n\n    return () => { cancelled = true; supabase.removeChannel(ch) }\n  }, [])\n\n  if (loading) return <div className=\"text-white/70 text-sm\">Loadingâ€¦</div>\n  if (error)   return <div className=\"text-red-400 text-sm\">Error: {error}</div>\n  if (!rows.length) return <div className=\"text-white/60 text-sm\">No incidents yet.</div>\n\n  return (\n    <div className=\"space-y-4\">\n      {rows.map((r) => (\n        <div\n          key={r.id}\n          className={`bg-white/[0.03] hover:bg-white/[0.06] border border-white/10 rounded-lg p-4 transition-all duration-200 hover:scale-[1.02] overflow-hidden ${\n            r.lat && r.lon && !isNaN(r.lat) && !isNaN(r.lon) && r.lat !== 0 && r.lon !== 0\n              ? 'cursor-pointer' \n              : 'cursor-not-allowed opacity-60'\n          }`}\n          onClick={() => onIncidentClick?.(r)}\n        >\n          <div className=\"flex items-start justify-between mb-3\">\n            <span className=\"text-xs font-mono text-white/50\">{r.id.slice(0,8).toUpperCase()}</span>\n            <PriorityBadge priority={r.priority} risk={r.risk} />\n          </div>\n\n          <p className=\"text-sm font-semibold mb-2 text-white break-words leading-tight\">\n            {r.name ?? 'Unnamed Incident'}\n          </p>\n\n          <div className=\"flex items-center gap-2 text-xs text-white/60\">\n            <MapPin className=\"w-3 h-3\" />\n            <span>\n              {r.lat?.toFixed(1) ?? 'â€”'}Â°N, {r.lon?.toFixed(1) ?? 'â€”'}Â°W\n            </span>\n          </div>\n\n          <div className=\"flex items-center justify-between mt-2\">\n            <div className=\"text-xs text-white/50\">\n              Status:{' '}\n              <span className=\"text-[#00C2FF] font-medium\">\n                {(r.containment ?? 0)}% resolved\n              </span>\n            </div>\n            {r.incident_type && (\n              <span className=\"text-xs text-white/40 italic\">\n                {r.incident_type}\n              </span>\n            )}\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3766, "column": 0}, "map": {"version":3,"sources":["file:///Users/leonliu/projects/tartanhacks/app/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useCallback } from \"react\"\nimport { Play, SkipBack, SkipForward, Wind, Activity, AlertTriangle, Mic, Volume2, ChevronLeft, ChevronRight, PanelLeft, PanelRight, MicOff, ChevronUp, Minimize2, Bot, Shield } from \"lucide-react\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Button } from \"@/components/ui/button\"\nimport CaliforniaMap from \"@/components/california-map\"\nimport LeafletMap from \"@/components/leaflet-map\"\nimport { useVapi } from \"@/hooks/use-vapi\"\nimport { useWeather } from \"@/hooks/use-weather\"\nimport IncidentsList from '@/components/IncidentsList'\nimport { PoliceIncident, FireIncident } from '@/lib/composio-telegram-service'\n\n// Helper functions for severity-based colors\nfunction getHumidityColor(humidity: number): string {\n  if (humidity < 20) return '#FF4444'; // Critical - very dry, high fire risk\n  if (humidity < 30) return '#FF6B00'; // High risk\n  if (humidity < 50) return '#FFA800'; // Moderate\n  return '#00C2FF'; // Good\n}\n\nfunction getTemperatureColor(temp: number): string {\n  if (temp >= 100) return '#FF4444'; // Extreme heat\n  if (temp >= 90) return '#FF6B00'; // Very hot\n  if (temp >= 80) return '#FFA800'; // Hot\n  if (temp >= 70) return '#00C2FF'; // Warm\n  if (temp >= 50) return '#00FFB3'; // Mild\n  return '#00C2FF'; // Cool\n}\n\nfunction getVisibilityColor(visibilityMiles: number): string {\n  if (visibilityMiles < 1) return '#FF4444'; // Poor\n  if (visibilityMiles < 3) return '#FF6B00'; // Moderate\n  if (visibilityMiles < 6) return '#FFA800'; // Fair\n  return '#00C2FF'; // Good\n}\n\nfunction getVisibilityLabel(visibilityMiles: number): string {\n  if (visibilityMiles < 1) return 'Poor';\n  if (visibilityMiles < 3) return 'Moderate';\n  if (visibilityMiles < 6) return 'Fair';\n  return 'Good';\n}\n\nfunction getAirQualityColor(aqi: number): string {\n  if (aqi >= 201) return '#8B1A1A'; // Very Unhealthy (Purple/Maroon)\n  if (aqi >= 151) return '#FF4444'; // Unhealthy (Red)\n  if (aqi >= 101) return '#FF6B00'; // Unhealthy for Sensitive Groups (Orange)\n  if (aqi >= 51) return '#FFA800'; // Moderate (Yellow)\n  return '#00FFB3'; // Good (Green)\n}\n\nfunction getAirQualityLabel(aqi: number): string {\n  if (aqi >= 201) return 'Very Unhealthy';\n  if (aqi >= 151) return 'Unhealthy';\n  if (aqi >= 101) return 'Unhealthy (Sensitive)';\n  if (aqi >= 51) return 'Moderate';\n  return 'Good';\n}\n\nexport default function OrionDashboard() {\n  const [leftSidebarCollapsed, setLeftSidebarCollapsed] = useState(false)\n  const [rightSidebarCollapsed, setRightSidebarCollapsed] = useState(false)\n  const [aiAssistantCollapsed, setAiAssistantCollapsed] = useState(false)\n  const [environmentalConditionsCollapsed, setEnvironmentalConditionsCollapsed] = useState(false)\n  const [activeIncidentsCollapsed, setActiveIncidentsCollapsed] = useState(false)\n  const [incidentCount, setIncidentCount] = useState(0)\n  const [currentIncidents, setCurrentIncidents] = useState<PoliceIncident[]>([])\n  const [selectedIncident, setSelectedIncident] = useState<PoliceIncident | null>(null)\n  const [alertSending, setAlertSending] = useState(false)\n  const [alertStatus, setAlertStatus] = useState<string | null>(null)\n  const [unitStats, setUnitStats] = useState<{ available: number; dispatched: number; active: number; eta?: string }>({ available: 0, dispatched: 0, active: 0 })\n  const [allUnitStats, setAllUnitStats] = useState<{ available: number; dispatched: number; active: number }>({ available: 0, dispatched: 0, active: 0 })\n  const [dispatchSending, setDispatchSending] = useState(false)\n  const [refreshUnitTrigger, setRefreshUnitTrigger] = useState(0)\n  const [viewMode, setViewMode] = useState<'3d' | '2d'>('3d')\n  const [searchInput, setSearchInput] = useState('')\n\n  // VAPI voice integration\n  const { isSessionActive, isSpeaking, messages: vapiMessages, volumeLevel, start, stop, receiveAgentMessage } = useVapi()\n  \n  // Map center tracking for weather\n  const [mapCenter, setMapCenter] = useState<{ lat: number; lon: number } | null>(null)\n  const { weather, loading: weatherLoading } = useWeather(mapCenter?.lat ?? null, mapCenter?.lon ?? null)\n  \n  // Poll for AI agent messages\n  useEffect(() => {\n    let lastTimestamp: string | null = null;\n    \n    const pollAgentMessages = async () => {\n      try {\n        const url = lastTimestamp \n          ? `/api/vapi-webhook?since=${encodeURIComponent(lastTimestamp)}`\n          : '/api/vapi-webhook';\n        \n        const response = await fetch(url);\n        const data = await response.json();\n        \n        if (data.messages && data.messages.length > 0) {\n          // Process each new message\n          data.messages.forEach((msg: any) => {\n            receiveAgentMessage({\n              action: msg.action,\n              message: msg.message,\n              data: msg.data\n            });\n          });\n          \n          // Update last timestamp\n          lastTimestamp = data.latest_timestamp;\n        }\n      } catch (error) {\n        console.error('Error polling agent messages:', error);\n      }\n    };\n    \n    // Poll every 5 seconds\n    const interval = setInterval(pollAgentMessages, 5000);\n    pollAgentMessages(); // Initial poll\n    \n    return () => clearInterval(interval);\n  }, [receiveAgentMessage])\n  \n  // Map navigation function\n  const [navigateToIncident, setNavigateToIncident] = useState<((incident: any) => void) | null>(null)\n  const [leafletFlyTo, setLeafletFlyTo] = useState<((lat: number, lon: number, zoom?: number) => void) | null>(null)\n  \n  // Map ready callback\n  const handleMapReady = (navFunction: any) => {\n    setNavigateToIncident(() => navFunction);\n  };\n  const handleLeafletReady = (fly: any) => {\n    setLeafletFlyTo(() => fly)\n  }\n\n  // Map movement callback\n  const handleMapMove = (center: { lat: number; lon: number }) => {\n    setMapCenter(center);\n  };\n  \n  const handleVoiceToggle = () => {\n    if (isSessionActive) {\n      stop()\n    } else {\n      start()\n    }\n  }\n\n  const handleIncidentSelect = (incident: any) => {\n    if (!incident) {\n      console.warn('No incident provided to handleIncidentSelect');\n      return;\n    }\n    \n    // Convert to PoliceIncident format with last_update\n    const policeIncident: PoliceIncident = {\n      id: typeof incident.id === 'string' ? incident.id : String(incident.id || ''),\n      name: incident.name || null,\n      priority: incident.priority || incident.risk || null, // Support both priority and risk\n      lat: incident.lat || null,\n      lon: incident.lon || null,\n      containment: incident.containment || null,\n      last_update: incident.last_update || new Date().toISOString(),\n      description: incident.description || null,\n      incident_type: incident.incident_type || null\n    };\n    setSelectedIncident(policeIncident);\n  };\n\n  const handleSearch = () => {\n    if (!searchInput.trim()) return;\n    const coords = searchInput.split(',').map((s) => parseFloat(s.trim()));\n    if (coords.length === 2 && !isNaN(coords[0]) && !isNaN(coords[1])) {\n      leafletFlyTo?.(coords[0], coords[1], 14);\n      navigateToIncident?.({ lat: coords[0], lon: coords[1] });\n      return;\n    }\n    const aliases: Record<string, {lat:number, lon:number}> = {\n      'cmu': { lat: 40.4433, lon: -79.9436 },\n      'forbes': { lat: 40.4427, lon: -79.9425 },\n      'downtown': { lat: 40.4406, lon: -79.9959 },\n    };\n    const key = searchInput.toLowerCase();\n    if (aliases[key]) {\n      const target = aliases[key];\n      leafletFlyTo?.(target.lat, target.lon, 14);\n      navigateToIncident?.({ lat: target.lat, lon: target.lon });\n    }\n  }\n\n  const handleUnitUpdate = useCallback(async (stats: { available: number; dispatched: number; active: number }, activeUnits?: any[]) => {\n    // Store global stats\n    setAllUnitStats(stats);\n    \n    // If we have a selected incident, calculate stats for nearby police stations\n    if (selectedIncident && activeUnits) {\n      try {\n        // Fetch all police stations with their unit stats\n        const response = await fetch('/api/dispatch-unit');\n        const data = await response.json();\n        \n        if (data.stats) {\n          // Calculate distance from incident to each station\n          const calculateDistance = (lat1: number, lon1: number, lat2: number, lon2: number) => {\n            const R = 6371; // Earth's radius in km\n            const dLat = (lat2 - lat1) * Math.PI / 180;\n            const dLon = (lon2 - lon1) * Math.PI / 180;\n            const a = \n              Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n              Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n              Math.sin(dLon / 2) * Math.sin(dLon / 2);\n            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n            return R * c;\n          };\n          \n          // Get police stations data\n          const stationsResponse = await fetch('/api/incident-state');\n          const stationsData = await stationsResponse.json();\n          const stations = stationsData.stations || [];\n          \n          // Find stations within 100km of this incident\n          const nearbyStations = stations.filter((station: any) => {\n            const distance = calculateDistance(\n              selectedIncident.lat || 0,\n              selectedIncident.lon || 0,\n              station.lat,\n              station.lon\n            );\n            return distance <= 100; // 100km radius\n          });\n          \n          // Calculate available units from nearby stations only\n          const nearbyStationIds = new Set(nearbyStations.map((s: any) => s.id));\n          const availableNearby = data.stats\n            .filter((s: any) => nearbyStationIds.has(s.station_id))\n            .reduce((sum: number, s: any) => sum + (s.available_units || 0), 0);\n          \n          // Filter for THIS incident\n          const incidentId = String(selectedIncident.id);\n          const forThisIncident = activeUnits.filter((u: any) => String(u.incident_id) === incidentId);\n          \n          const dispatched = forThisIncident.filter((u: any) => u.status === 'dispatched' || u.status === 'en_route').length;\n          const active = forThisIncident.filter((u: any) => u.status === 'on_scene').length;\n          \n          // Calculate ETA for dispatched units\n          let eta = undefined;\n          if (dispatched > 0) {\n            // Find nearest station to incident\n            let minDistance = Infinity;\n            for (const station of nearbyStations) {\n              const distance = calculateDistance(\n                selectedIncident.lat || 0,\n                selectedIncident.lon || 0,\n                station.lat,\n                station.lon\n              );\n              if (distance < minDistance) {\n                minDistance = distance;\n              }\n            }\n            // Assume average speed of 60 mph (1 mile per minute)\n            // Convert km to miles and calculate minutes\n            const distanceMiles = minDistance * 0.621371;\n            const estimatedMinutes = Math.ceil(distanceMiles / 1.0); // 60 mph = 1 mile per minute\n            eta = `${estimatedMinutes} min`;\n          }\n          \n          setUnitStats({\n            available: availableNearby, // Available units from nearby stations only\n            dispatched: dispatched, // Units en route to THIS incident\n            active: active, // Units on scene at THIS incident\n            eta: eta\n          });\n        }\n      } catch (error) {\n        console.error('Error fetching incident-specific stats:', error);\n        // Fallback to global stats\n        setUnitStats(stats);\n      }\n    } else {\n      // No incident selected, show global stats\n      setUnitStats(stats);\n    }\n  }, [selectedIncident]);\n\n  // Update unit stats when selected incident changes\n  useEffect(() => {\n    // Trigger a recalculation of stats for the new incident\n    setRefreshUnitTrigger(prev => prev + 1);\n  }, [selectedIncident?.id]);\n\n  const handleIncidentClick = (incident: any) => {\n    // Validate incident object and coordinates before attempting navigation\n    // Note: navigateToIncident will call onIncidentSelect which sets selectedIncident\n    if (incident && \n        incident.lat && incident.lon && \n        !isNaN(incident.lat) && !isNaN(incident.lon) &&\n        incident.lat !== 0 && incident.lon !== 0 &&\n        navigateToIncident) {\n      handleIncidentSelect(incident)\n      navigateToIncident(incident)\n    } else {\n      console.warn('Cannot navigate to incident with invalid data:', {\n        incident: incident ? incident.id : 'null',\n        name: incident?.name,\n        lat: incident?.lat,\n        lon: incident?.lon\n      });\n    }\n  }\n\n  const handleEmergencyAlert = async () => {\n    if (!selectedIncident) {\n      setAlertStatus('Please select an incident first');\n      setTimeout(() => setAlertStatus(null), 3000);\n      return;\n    }\n\n    setAlertSending(true);\n    setAlertStatus(null);\n\n    try {\n      const response = await fetch('/api/send-emergency-alert', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          incident: selectedIncident,\n        }),\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        setAlertStatus(`Emergency alert sent successfully! Message ID: ${result.messageSid}`);\n      } else {\n        setAlertStatus(`Failed to send alert: ${result.error}`);\n      }\n    } catch (error) {\n      console.error('Error sending emergency alert:', error);\n      setAlertStatus('Failed to send emergency alert. Please try again.');\n    } finally {\n      setAlertSending(false);\n      // Clear status after 5 seconds\n      setTimeout(() => setAlertStatus(null), 5000);\n    }\n  }\n\n  const handleDispatchUnit = async () => {\n    if (!selectedIncident) {\n      console.warn('[UI] No incident selected');\n      return;\n    }\n\n    if (unitStats.available === 0) {\n      console.warn('[UI] No available units');\n      return;\n    }\n\n    console.log('[UI] Dispatching unit for incident:', selectedIncident.id);\n    setDispatchSending(true);\n\n    try {\n      const response = await fetch('/api/dispatch-unit', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          incidentId: selectedIncident.id,\n          incidentLat: selectedIncident.lat,\n          incidentLon: selectedIncident.lon,\n        }),\n      });\n\n      const result = await response.json();\n      console.log('[UI] Dispatch response:', result);\n\n      if (result.success) {\n        console.log('[UI] âœ… Dispatch successful, refreshing unit data');\n        // Trigger unit refresh\n        setRefreshUnitTrigger(prev => prev + 1);\n      } else {\n        console.error('[UI] âŒ Dispatch failed:', result.error);\n        console.error('[UI] Error details:', result.details);\n        console.error('[UI] Full response:', result);\n      }\n    } catch (error) {\n      console.error('[UI] Error dispatching unit:', error);\n    } finally {\n      setDispatchSending(false);\n    }\n  }\n\n  // Calculate dynamic height based on actual incident count and content\n  const calculateDynamicHeight = () => {\n    if (incidentCount === 0) return 200 // Minimum height when no incidents\n    \n    // Calculate based on actual content - no extra padding at bottom:\n    // - Header section: ~80px (title + padding)\n    // - Each incident item: ~120px (actual content size)\n    // - Space between items: 16px (space-y-4)\n    // - Container padding: 48px (p-6 = 24px top + 24px bottom)\n    \n    const headerHeight = 80\n    const containerPadding = 48\n    const itemHeight = 120 // Actual content size\n    const itemSpacing = 16\n    \n    // Calculate exact height needed - no extra space\n    const totalItemHeight = incidentCount * itemHeight\n    const totalSpacingHeight = Math.max(0, (incidentCount - 1) * itemSpacing)\n    const exactContentHeight = headerHeight + containerPadding + totalItemHeight + totalSpacingHeight\n    \n    // Set reasonable bounds\n    const minHeight = 200\n    const maxHeight = 600\n    \n    return Math.max(minHeight, Math.min(exactContentHeight, maxHeight))\n  }\n\n  return (\n    <div className=\"h-screen w-full flex flex-col overflow-hidden relative\">\n      {/* Full-screen interactive map background */}\n      <div className=\"absolute inset-0 z-0\">\n        {viewMode === '3d' ? (\n          <CaliforniaMap \n            className=\"w-full h-full\" \n            onMapReady={handleMapReady}\n            onMapMove={handleMapMove}\n            windSpeed={weather?.wind.speed}\n            windDirection={weather?.wind.deg}\n            onIncidentSelect={handleIncidentSelect}\n            onUnitUpdate={handleUnitUpdate}\n            refreshUnitTrigger={refreshUnitTrigger}\n            selectedIncidentId={selectedIncident?.id || null}\n          />\n        ) : (\n          <LeafletMap onReady={handleLeafletReady} />\n        )}\n      </div>\n\n      {/* Top Navigation - Glass Panel */}\n      <header className=\"relative h-16 glass-panel-interactive rounded-none border-b border-white/10 flex items-center justify-between px-8 shrink-0 z-20 fade-in\">\n        <div className=\"flex items-center gap-8\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-8 h-8 bg-[#3b82f6] rounded-lg flex items-center justify-center\">\n              <Shield className=\"w-5 h-5 text-white\" />\n            </div>\n            <h1 className=\"text-xl font-semibold tracking-tight text-white\">Police Dispatch</h1>\n          </div>\n          <span className=\"text-sm text-white/70 font-medium\">Control Center</span>\n        </div>\n\n        <div className=\"flex items-center gap-8\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-2 h-2 rounded-full bg-[#00C2FF] cyan-glow\" />\n            <span className=\"text-sm text-white/90 font-medium\">Operational</span>\n          </div>\n          <div className=\"flex items-center gap-2 text-white/70\">\n            <Wind className=\"w-4 h-4\" />\n            <span className=\"text-sm font-medium\">\n              {weatherLoading ? (\n                \"Loading...\"\n              ) : weather ? (\n                `${weather.wind.speed} mph ${weather.wind.direction}`\n              ) : (\n                \"15 mph NW\"\n              )}\n            </span>\n          </div>\n          <div className=\"flex items-center gap-1 bg-white/5 rounded-lg px-2 py-1 border border-white/10\">\n            <Button size=\"sm\" variant={viewMode === '3d' ? 'default' : 'ghost'} onClick={() => setViewMode('3d')}>\n              3D\n            </Button>\n            <Button size=\"sm\" variant={viewMode === '2d' ? 'default' : 'ghost'} onClick={() => setViewMode('2d')}>\n              2D\n            </Button>\n          </div>\n          <div className=\"flex items-center gap-2 bg-white/5 px-3 py-1 rounded-lg border border-white/10\">\n            <input\n              className=\"bg-transparent text-sm outline-none placeholder-white/60 w-40\"\n              placeholder=\"Search: lat,lon or 'cmu'\"\n              value={searchInput}\n              onChange={(e) => setSearchInput(e.target.value)}\n              onKeyDown={(e) => e.key === 'Enter' && handleSearch()}\n            />\n            <Button size=\"sm\" variant=\"secondary\" onClick={handleSearch}>Go</Button>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"relative flex-1 flex gap-6 p-6 overflow-hidden z-10 pointer-events-none\">\n        {/* Left Sidebar - Overview */}\n        <aside className=\"w-[320px] flex flex-col gap-4 pointer-events-auto\">\n          {/* Active Incidents */}\n          <div className=\"glass-panel rounded-xl fade-in\">\n            {activeIncidentsCollapsed ? (\n              /* Collapsed State */\n              <div \n                className=\"p-3 cursor-pointer hover:bg-white/5 transition-all duration-200\"\n                onClick={() => setActiveIncidentsCollapsed(false)}\n              >\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <h2 className=\"text-sm font-semibold text-white\">Active Incidents</h2>\n                    <Badge className=\"bg-[#FF6B00]/20 text-[#FF6B00] border-0 text-xs font-medium px-2 py-1\">{incidentCount}</Badge>\n                </div>\n                  <ChevronUp className=\"w-4 h-4 text-white/60\" />\n                </div>\n              </div>\n            ) : (\n              /* Expanded State */\n              <div \n                className=\"p-6 flex flex-col overflow-hidden\"\n                style={{ \n                  minHeight: '200px', \n                  maxHeight: '420px',\n                  height: `${Math.min(calculateDynamicHeight(), 420)}px`\n                }}\n              >\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h2 className=\"text-base font-semibold text-white\">Active Incidents</h2>\n                  <div className=\"flex items-center gap-2\">\n                  <Badge className=\"bg-[#FF6B00]/20 text-[#FF6B00] border-0 text-xs font-medium px-2 py-1\">{incidentCount}</Badge>\n                    <Button\n                      onClick={() => setActiveIncidentsCollapsed(true)}\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      className=\"h-6 w-6 p-0 hover:bg-white/10 rounded-md transition-all duration-200\"\n                    >\n                      <Minimize2 className=\"w-3 h-3 text-white/60\" />\n                    </Button>\n                  </div>\n            </div>\n\n                <div className=\"flex-1 overflow-y-auto hide-scrollbar\">\n                  <IncidentsList \n                    onIncidentClick={handleIncidentClick} \n                    onIncidentCountChange={setIncidentCount}\n                    onIncidentsUpdate={setCurrentIncidents}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Unit Status & Controls - Show when incident is selected */}\n          {selectedIncident && (\n            <div className=\"glass-panel rounded-lg fade-in p-2 space-y-1.5 mt-2\">\n              {/* Compact Header */}\n              <div className=\"flex items-center gap-1.5 mb-1\">\n                <span className=\"text-xs\">ðŸš“</span>\n                <h4 className=\"text-[10px] font-semibold text-white\">Available Units</h4>\n              </div>\n              \n              {/* Compact Unit Stats */}\n              <div className=\"grid grid-cols-3 gap-1 text-center\">\n                <div className=\"bg-white/5 rounded p-1\">\n                  <div className=\"text-base font-bold text-[#00FFB3] leading-none\">{unitStats.available}</div>\n                  <div className=\"text-[9px] text-white/60 mt-0.5\">Available</div>\n                </div>\n                <div className=\"bg-white/5 rounded p-1\">\n                  <div className=\"text-base font-bold text-[#FFA800] leading-none\">{unitStats.dispatched}</div>\n                  <div className=\"text-[9px] text-white/60 mt-0.5\">En Route</div>\n                </div>\n                <div className=\"bg-white/5 rounded p-1\">\n                  <div className=\"text-base font-bold text-[#FF6B00] leading-none\">{unitStats.active}</div>\n                  <div className=\"text-[9px] text-white/60 mt-0.5\">On Scene</div>\n                </div>\n              </div>\n\n              {/* ETA Display - Only show when units are en route */}\n              {unitStats.eta && unitStats.dispatched > 0 && (\n                <div className=\"bg-blue-500/10 border border-blue-400/20 rounded px-2 py-1 text-center\">\n                  <span className=\"text-[9px] text-blue-300/70\">ETA:</span>\n                  <span className=\"text-xs font-bold text-blue-400 ml-1\">{unitStats.eta}</span>\n                </div>\n              )}\n\n              {/* Compact Dispatch Button */}\n              <Button \n                onClick={handleDispatchUnit}\n                disabled={dispatchSending || !selectedIncident || unitStats.available === 0}\n                className={`w-full border-0 h-8 rounded-md text-[10px] font-semibold shadow-lg transition-all duration-200 ${\n                  selectedIncident && !dispatchSending && unitStats.available > 0\n                    ? 'bg-gradient-to-r from-[#3b82f6] to-[#1e40af] hover:from-[#3b82f6]/90 hover:to-[#1e40af]/90 text-white hover:scale-[1.02]'\n                    : 'bg-white/10 text-white/40 cursor-not-allowed'\n                }`}\n              >\n                <Shield className=\"w-3 h-3 mr-1\" />\n                {dispatchSending ? 'Dispatching...' : unitStats.available > 0 ? `Send Unit` : 'No Units'}\n              </Button>\n            </div>\n          )}\n        </aside>\n\n        {/* Center - Transparent area for map interaction */}\n        <main className=\"flex-1 relative pointer-events-none\">\n          {/* This area allows map interaction while being transparent */}\n        </main>\n\n        {/* Right Sidebar - Relative Base Positions with Independent Movement */}\n        <aside className=\"w-[380px] h-[calc(100vh-8rem)] relative pointer-events-auto\">\n          {/* AI Assistant - Base Position Relative to Top */}\n          <div className=\"glass-panel-interactive rounded-xl fade-in absolute top-0 right-0 w-full z-20\">\n            {aiAssistantCollapsed ? (\n              /* Collapsed State */\n              <div className=\"p-3\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <h2 className=\"text-sm font-semibold text-white\">AI Assistant</h2>\n                    {/* Microphone button next to title */}\n                    <Button\n                      onClick={handleVoiceToggle}\n                      size=\"sm\"\n                      className={`transition-all duration-300 ${\n                        isSessionActive\n                          ? 'bg-[#FF6B00] hover:bg-[#FF6B00]/90 fire-glow'\n                          : 'bg-white/10 hover:bg-white/20'\n                      }`}\n                    >\n                      {isSessionActive ? (\n                        <MicOff className=\"w-4 h-4 text-white\" />\n                      ) : (\n                        <Mic className=\"w-4 h-4 text-white\" />\n                      )}\n                    </Button>\n                  </div>\n                  \n                  <div className=\"flex items-center gap-3\">\n                    {/* Status indicator on the right */}\n                    <div className=\"flex items-center gap-2\">\n                      <div className={`w-1.5 h-1.5 rounded-full ${isSessionActive ? 'bg-[#00C2FF] cyan-glow' : 'bg-white/20'}`} />\n                      <span className=\"text-xs text-white/70 font-medium\">{isSessionActive ? 'Live' : 'Offline'}</span>\n                    </div>\n                    \n                    {/* Expand button */}\n                    <Button\n                      onClick={() => setAiAssistantCollapsed(false)}\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      className=\"h-6 w-6 p-0 hover:bg-white/10 rounded-md transition-all duration-200\"\n                    >\n                      <ChevronUp className=\"w-3 h-3 text-white/60\" />\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            ) : (\n              /* Expanded State */\n              <div className=\"p-6 flex flex-col gap-4 h-[350px] overflow-hidden\">\n                <div className=\"flex items-center justify-between\">\n                  <h2 className=\"text-base font-semibold text-white\">AI Voice Assistant</h2>\n                  <div className=\"flex items-center gap-3\">\n                    {/* Voice Control Button */}\n                    <Button\n                      onClick={handleVoiceToggle}\n                      size=\"sm\"\n                      className={`transition-all duration-300 ${\n                        isSessionActive\n                          ? 'bg-[#FF6B00] hover:bg-[#FF6B00]/90 fire-glow'\n                          : 'bg-white/10 hover:bg-white/20'\n                      }`}\n                    >\n                      {isSessionActive ? (\n                        <MicOff className=\"w-4 h-4 text-white\" />\n                      ) : (\n                        <Mic className=\"w-4 h-4 text-white\" />\n                      )}\n                    </Button>\n                    \n                    <div className=\"flex items-center gap-2\">\n                      <div className={`w-2 h-2 rounded-full ${isSessionActive ? 'bg-[#00C2FF] cyan-glow' : 'bg-white/20'}`} />\n                      <span className=\"text-xs text-white/70 font-medium\">{isSessionActive ? 'Live' : 'Offline'}</span>\n                    </div>\n                    \n                    <Button\n                      onClick={() => setAiAssistantCollapsed(true)}\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      className=\"h-6 w-6 p-0 hover:bg-white/10 rounded-md transition-all duration-200\"\n                    >\n                      <Minimize2 className=\"w-3 h-3 text-white/60\" />\n                    </Button>\n                  </div>\n                </div>\n\n                {/* Volume Level Indicator */}\n                {isSessionActive && (\n                  <div className=\"flex items-center gap-3 px-4 py-2 bg-white/5 rounded-lg\">\n                    <Activity className=\"w-4 h-4 text-[#00C2FF]\" />\n                    <div className=\"flex-1 h-2 bg-white/10 rounded-full overflow-hidden\">\n                      <div\n                        className=\"h-full bg-gradient-to-r from-[#00C2FF] to-[#00C2FF]/80 rounded-full transition-all duration-100\"\n                        style={{ width: `${Math.min(volumeLevel * 100, 100)}%` }}\n                      />\n                    </div>\n                  </div>\n                )}\n\n                <div className=\"flex-1 overflow-y-auto space-y-4 pr-2\">\n                  {/* Show VAPI messages if session has been started, otherwise show welcome message */}\n                  {vapiMessages.length > 0 || isSessionActive ? (\n                    <>\n                      {vapiMessages.map((message, index) => (\n                        <div\n                          key={index}\n                          className={`space-y-3 ${\n                            index !== vapiMessages.length - 1 ? 'border-b border-white/10 pb-4' : ''\n                          }`}\n                        >\n                          <div className=\"flex items-center gap-2\">\n                            {message.role === 'assistant' ? (\n                              <Volume2 className=\"w-4 h-4 text-[#00C2FF]\" />\n                            ) : (\n                              <Mic className=\"w-4 h-4 text-white/60\" />\n                            )}\n                            <span className=\"text-xs text-white/60 font-mono\">\n                              {message.timestamp}\n                            </span>\n                          </div>\n                          <p className=\"text-sm text-white/90 leading-relaxed font-medium\">\n                            {message.content}\n                          </p>\n                        </div>\n                      ))}\n                      {isSpeaking && (\n                        <div className=\"space-y-3 animate-pulse\">\n                          <div className=\"flex items-center gap-2\">\n                            <Volume2 className=\"w-4 h-4 text-[#00C2FF]\" />\n                            <span className=\"text-xs text-white/60 font-mono\">Now</span>\n                          </div>\n                          <p className=\"text-sm text-white/50 leading-relaxed font-medium italic\">\n                            Speaking...\n                          </p>\n                        </div>\n                      )}\n                    </>\n                  ) : (\n                    <div className=\"flex-1 flex items-center justify-center\">\n                      <div className=\"text-center space-y-4 max-w-md\">\n                        <div className=\"w-16 h-16 mx-auto rounded-full bg-[#FF6B00] flex items-center justify-center\">\n                          <Bot className=\"w-8 h-8 text-white\" />\n                        </div>\n                        <div>\n                          <p className=\"text-lg font-semibold text-white mb-2\">\n                            Welcome to Police Dispatch\n                          </p>\n                          <p className=\"text-sm text-white/70 mb-4\">\n                            Your AI-powered police dispatch assistant\n                          </p>\n                          <div className=\"text-left space-y-2 text-xs text-white/60\">\n                            <div className=\"flex items-start gap-2\">\n                              <span className=\"text-[#3b82f6] mt-0.5\">â€¢</span>\n                              <span>Real-time incident monitoring and alerts</span>\n                            </div>\n                            <div className=\"flex items-start gap-2\">\n                              <span className=\"text-[#3b82f6] mt-0.5\">â€¢</span>\n                              <span>Live weather and environmental conditions</span>\n                            </div>\n                            <div className=\"flex items-start gap-2\">\n                              <span className=\"text-[#3b82f6] mt-0.5\">â€¢</span>\n                              <span>Voice-activated incident reporting</span>\n                            </div>\n                            <div className=\"flex items-start gap-2\">\n                              <span className=\"text-[#3b82f6] mt-0.5\">â€¢</span>\n                              <span>Unit dispatch and coordination</span>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                   )}\n                 </div>\n               </div>\n             )}\n            </div>\n\n          {/* Environmental Conditions - Only show when incident is selected */}\n          {selectedIncident && (\n          <div className=\"glass-panel rounded-xl fade-in absolute top-[30px] right-0 w-full z-10\">\n            {environmentalConditionsCollapsed ? (\n              /* Collapsed State */\n              <div \n                className=\"p-3 cursor-pointer hover:bg-white/5 transition-all duration-200\"\n                onClick={() => setEnvironmentalConditionsCollapsed(false)}\n              >\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"text-sm font-semibold text-white\">Environmental Conditions</h3>\n                  <ChevronUp className=\"w-4 h-4 text-white/60\" />\n                </div>\n              </div>\n            ) : (\n              /* Expanded State */\n              <div className=\"p-4 flex flex-col overflow-hidden h-[240px]\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-base font-semibold text-white\">Environmental Conditions</h3>\n                  <Button\n                    onClick={() => setEnvironmentalConditionsCollapsed(true)}\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    className=\"h-6 w-6 p-0 hover:bg-white/10 rounded-md transition-all duration-200\"\n                  >\n                    <Minimize2 className=\"w-3 h-3 text-white/60\" />\n                  </Button>\n                </div>\n\n                <div className=\"flex-1 overflow-hidden\">\n                  <div className=\"flex gap-4 h-full\">\n                    {/* Left Half - Weather */}\n                    <div className=\"flex-1 space-y-3\">\n                      <h4 className=\"text-sm font-semibold text-white mb-3\">Weather</h4>\n                      <div className=\"space-y-3\">\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-sm text-white/70 font-medium\">Humidity</span>\n                          <span className=\"text-base font-bold\" style={{ \n                            color: weather ? getHumidityColor(weather.humidity) : '#00C2FF' \n                          }}>\n                            {weatherLoading ? '...' : weather ? `${weather.humidity}%` : 'N/A'}\n                          </span>\n                        </div>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-sm text-white/70 font-medium\">Temperature</span>\n                          <span className=\"text-base font-bold\" style={{ \n                            color: weather ? getTemperatureColor(weather.temp) : '#FF6B00' \n                          }}>\n                            {weatherLoading ? '...' : weather ? `${weather.temp}Â°F` : 'N/A'}\n                          </span>\n                        </div>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-sm text-white/70 font-medium\">Visibility</span>\n                          <span className=\"text-base font-bold\" style={{ \n                            color: weather?.visibility ? getVisibilityColor(weather.visibility) : '#00C2FF' \n                          }}>\n                            {weatherLoading ? '...' : weather?.visibility ? getVisibilityLabel(weather.visibility) : 'N/A'}\n                          </span>\n                        </div>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-sm text-white/70 font-medium\">Air Quality</span>\n                          <span className=\"text-base font-bold\" style={{ \n                            color: weather?.airQuality?.aqi ? getAirQualityColor(weather.airQuality.aqi) : '#FF4444' \n                          }}>\n                            {weatherLoading ? '...' : weather?.airQuality?.aqi ? getAirQualityLabel(weather.airQuality.aqi) : 'N/A'}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Right Half - Risk Factors */}\n                    <div className=\"flex-1 space-y-3\">\n                      <h4 className=\"text-sm font-semibold text-white mb-3\">Risk Factors</h4>\n                      <div className=\"space-y-3\">\n                        <div>\n                          <div className=\"flex justify-between text-sm mb-1\">\n                            <span className=\"text-white/70 font-medium\">Fire Danger</span>\n                            <span className=\"font-semibold text-[#FF4444]\">Extreme</span>\n                          </div>\n                          <div className=\"h-1.5 bg-white/10 rounded-full overflow-hidden\">\n                            <div className=\"h-full w-[95%] bg-gradient-to-r from-[#FF4444] to-[#FF4444]/80 rounded-full\" />\n                          </div>\n                        </div>\n                        <div>\n                          <div className=\"flex justify-between text-sm mb-1\">\n                            <span className=\"text-white/70 font-medium\">Fuel Moisture</span>\n                            <span className=\"font-semibold text-[#FF6B00]\">Critical</span>\n                          </div>\n                          <div className=\"h-1.5 bg-white/10 rounded-full overflow-hidden\">\n                            <div className=\"h-full w-[88%] bg-gradient-to-r from-[#FF6B00] to-[#FF6B00]/80 rounded-full\" />\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n          )}\n\n          {/* Emergency Alert - Only show when incident is selected */}\n          {selectedIncident && (\n          <div className=\"absolute bottom-0 right-0 w-full z-30 space-y-2\">\n            {/* Alert Status Message */}\n            {alertStatus && (\n              <div className={`p-3 rounded-lg text-xs font-medium animate-in slide-in-from-bottom-2 ${\n                alertStatus.includes('successfully') \n                  ? 'bg-green-500/20 text-green-400 border border-green-500/30' \n                  : 'bg-red-500/20 text-red-400 border border-red-500/30'\n              }`}>\n                {alertStatus.includes('successfully') ? 'âœ“ ' : 'âœ— '}\n                {alertStatus.replace('Emergency alert sent successfully! Message ID: ', 'Alert sent! SID: ')}\n              </div>\n            )}\n            \n            {/* Emergency Alert Button */}\n            <Button \n              onClick={handleEmergencyAlert}\n              disabled={alertSending || !selectedIncident}\n              className={`w-full border-0 h-12 rounded-xl font-semibold shadow-lg transition-all duration-200 ${\n                selectedIncident && !alertSending\n                  ? 'bg-[#FF6B00] hover:bg-[#FF6B00]/90 text-white hover:scale-[1.02]'\n                  : 'bg-white/10 text-white/40 cursor-not-allowed'\n              }`}\n            >\n              <AlertTriangle className=\"w-5 h-5 mr-2\" />\n              {alertSending ? 'Sending Alert...' : selectedIncident ? `Alert: ${selectedIncident.name}` : 'Select Incident First'}\n            </Button>\n          </div>\n          )}\n        </aside>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}